if (self.CavalryLogger) { CavalryLogger.start_js(["ARSKu"]); }

__d("MessengerReactions.react",["cx","fbt","Bootloader","CurrentUser","MercuryIDs","MercuryParticipants","MessengerEnvironment","MessengerReactionsUtil","MessengerReactionsPrompt.react","MessengerTextWithEmoticons.react","MessengerWebViewReactionsTypedLogger","TooltipData","React","ShimButton.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PropTypes,m="ALL",n=c("CurrentUser").getID(),o=3,p=9;j=babelHelpers.inherits(q,c("React").Component);k=j&&j.prototype;function q(){var r,s;for(var t=arguments.length,u=Array(t),v=0;v<t;v++)u[v]=arguments[v];return s=(r=k.constructor).call.apply(r,[this].concat(u)),this.$MessengerReactions2=function(){var w=c("MessengerEnvironment").messengerui,x=this.props,y=x.isFromViewer,z=x.message,A=x.participants,B=z.reactions;new(c("MessengerWebViewReactionsTypedLogger"))().setEvent("open_details").setMid(z.message_id).setSenderID(z.author).setEmojiGroup(m).setEmojiGroupCount(Object.values(B).length).log();if(w)c("Bootloader").loadModules(["messengerDialogsRe","messengerReactionsDialogReact"],function(C,D){var E=D.jsComponent;C.showDialog(function(){return c("React").createElement(E,{isFromViewer:y,participants:A,message:z})})},"MessengerReactions.react");else c("Bootloader").loadModules(["ChatReactionsDialog"],function(C){C.show(z,A,y)},"MessengerReactions.react")}.bind(this),s}q.prototype.render=function(){var r=this.props,s=r.message,t=r.participants,u=r.renderQuickAdd,v=s.reactions;if((!v||!t)&&!u)return null;var w={},x=0,y=false;Object.entries(v||{}).forEach(function(D){var E=D[0],F=D[1];if(typeof F==="string"){if(E===n)y=true;if(!w[F])w[F]=0;w[F]++;x++}});var z=Object.keys(w).sort(c("MessengerReactionsUtil").sortFunction).slice(0,o).map(function(D,E,v){return c("React").createElement("span",{className:"_4kf5",style:{zIndex:v.length-E,marginLeft:E===0?0:"-4px"},key:D},c("React").createElement(c("MessengerTextWithEmoticons.react"),{customSize:true,renderEmoticons:true,renderEmoji:true,text:D}))}),A=x>0?c("React").createElement("span",{className:"_4kf5 _4kf6"+(y?" _fy2":"")},x):null,B=u&&!y?c("React").createElement("div",{className:"_aou _aov"},c("React").createElement("span",{className:"_aow"},c("React").createElement(c("MessengerReactionsPrompt.react"),{message:s,messageIsSelected:true,isQuickAdd:true}))):null,C=c("TooltipData").propsFor(this.$MessengerReactions1());return c("React").createElement("div",babelHelpers["extends"]({},C,{className:"_4kf7 preview"}),c("React").createElement(c("ShimButton.react"),{className:"_aou",onClick:this.$MessengerReactions2},z,A),B)};q.prototype.$MessengerReactions1=function(){var r=this.props.message.reactions,s=this.props.participants;if(!r||!s)return"";var t=Object.keys(r),u=t.reduce(function(u,y){if(u.length>=p)return u;var z=c("MercuryIDs").getParticipantIDFromUserID(y),A=s.get(z)||c("MercuryParticipants").getNow(z),B=A&&A.name;if(B)u.push(B);return u},[]),v=u.length,w=u.join("\n");if(t.length>v){var x=i._("and {count} other(s)",[i.param("count",t.length-v)]);w+="\n"+x.toString()}return w};q.propTypes={isFromViewer:l.bool.isRequired,message:l.object.isRequired,participants:l.object,renderQuickAdd:l.bool};f.exports=q}),null);