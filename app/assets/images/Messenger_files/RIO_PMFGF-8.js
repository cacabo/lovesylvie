if (self.CavalryLogger) { CavalryLogger.start_js(["v3Q\/P"]); }

__d("MessengerView",[],(function a(b,c,d,e,f,g){f.exports={DETAIL:{COMPOSE:"detail/compose",THREAD:"detail/thread",PAYTHREAD:"detail/paythread",PAYFRIENDPICKER:"detail/payfriendpicker"},MASTER:{GROUPS:"master/groups",PAYMENT:"master/payment",PEOPLE:"master/people",RECENT:"master/recent",SUPPORT:"master/support",SEARCH:"master/search"}}}),null);
__d("MercuryTypeaheadConstants",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({COMPOSER_FRIENDS_MAX:4,COMPOSER_FB4C_MAX:4,COMPOSER_NON_FRIENDS_MAX:2,COMPOSER_MESSENGER_ONLY_CONTACT_MAX:4,COMPOSER_SHOW_MORE_LIMIT:2,COMPOSER_THREADS_INITIAL_LIMIT:2,COMPOSER_CHATTAB_MAX:5,COMPOSER_PAGES_MAX:5,COMPOSER_WM_MAX:19,USER_TYPE:"user",PAGE_TYPE:"page",THREAD_TYPE:"thread",HEADER_TYPE:"header",SEARCH_TYPE:"search",FRIEND_TYPE:"friend",NON_FRIEND_TYPE:"non_friend",FB4C_TYPE:"fb4c",MEETING_ROOM_PAGE_TYPE:"meeting_room_page",COMMERCE_PAGE_TYPE:"commerce_page",INTERNAL_BOT_PAGE_TYPE:"internal_bot_page",GAME_TYPE:"game",WORKPLACE_BOT_CATEGORY_TYPE:"WORKPLACE_BOT",VALID_EMAIL:"^([A-Z0-9._%+-]+@((?!facebook\\.com))[A-Z0-9.-]+\\.[A-Z]{2,4}|(([A-Z._%+-]+[A-Z0-9._%+-]*)|([A-Z0-9._%+-]+[A-Z._%+-]+[A-Z0-9._%+-]*))@(?:facebook\\.com))$"})}),null);
__d("MessengerStateProcessor",["MercuryAPIArgsSource","MercuryIDs","MercuryParticipantTypes","MercuryParticipants","MercuryThreadIDMap","MercuryThreads","mercuryVanityIDMapRe","MessengerURIConstants"],(function a(b,c,d,e,f,g){"use strict";var h={preprocess:function j(k){var l=k.activeThreadID;if(l){var m=c("MercuryIDs").getUserIDFromThreadID(l),n=m&&c("MercuryParticipants").getNow(c("MercuryIDs").getParticipantIDFromUserID(m));if(n&&n.type!==c("MercuryParticipantTypes").EVENT)k.threadKey=n.vanity||m;else if(m&&!n){var o=c("MercuryIDs").getParticipantIDFromUserID(m);k.threadKey=c("mercuryVanityIDMapRe").hasID(o)?c("mercuryVanityIDMapRe").getVanity(o):m}else{var p=c("MercuryThreadIDMap").get(),q=p.getServerIDFromClientIDNow(l);k.threadKey=q||c("MercuryIDs").tokenize(l).value}}delete k.activeThreadID;return k},postprocess:function j(k){var l=c("MercuryThreadIDMap").get(),m=c("MercuryThreads").get(),n=i(k.threadKey),o=void 0;o=c("MercuryIDs").isValid(n)?n:l.getClientIDFromServerIDNow(n);if(!o){var p=c("MercuryParticipants").getIDFromVanityOrFBID(n),q=p&&m.getCanonicalThreadToParticipant(p,null,c("MercuryAPIArgsSource").MESSENGER);if(q)o=q.thread_id}if(o){k.activeThreadID=o;k.serverThreadID=l.getServerIDFromClientIDNow(o)}delete k.threadKey;return k},supportInboxPostprocess:function j(k){if(k.threadKey)k.activeThreadID=c("MercuryIDs").getThreadIDFromSupportInboxItemID(k.threadKey);delete k.threadKey;return k}};function i(j){if(!j)return null;return j.startsWith(c("MessengerURIConstants").GROUP_PREFIX)?j.substr(c("MessengerURIConstants").GROUP_PREFIX.length):j}f.exports=h}),null);
__d("MessengerURISerializer",["CurrentEnvironment","MercuryFilters","MessagingTag","MessengerStateProcessor","MessengerURIConstants","MessengerView","URI","WWWBase","MercuryIDs"],(function a(b,c,d,e,f,g){"use strict";var h="/?$",i=function i(m,n){m.setPath(c("CurrentEnvironment").facebookdotcom?c("MessengerURIConstants").FACEBOOK_PREFIX+n:n)},j=function j(m,n){var o=m.getPath();if(c("CurrentEnvironment").facebookdotcom&&!o.startsWith(c("MessengerURIConstants").FACEBOOK_PREFIX))n=c("MessengerURIConstants").FACEBOOK_PREFIX+n;m.setPath(m.getPath()+n)},k={serialize:function m(n){var o=new(c("URI"))(c("WWWBase").uri);n=c("MessengerStateProcessor").preprocess(n);switch(n.masterView){case c("MessengerView").MASTER.GROUPS:i(o,c("MessengerURIConstants").GROUPS_PATH);break;case c("MessengerView").MASTER.PAYMENT:i(o,c("MessengerURIConstants").PAYMENT_PATH);break;case c("MessengerView").MASTER.PEOPLE:i(o,c("MessengerURIConstants").PEOPLE_PATH);break;case c("MessengerView").MASTER.SUPPORT:i(o,c("MessengerURIConstants").SUPPORT_PATH);break}switch(n.folder){case c("MessagingTag").OTHER:i(o,c("MessengerURIConstants").FILTERED_REQUESTS_PATH);break;case c("MessagingTag").ACTION_ARCHIVED:i(o,c("MessengerURIConstants").ARCHIVED_PATH);break;case c("MessagingTag").PENDING:i(o,c("MessengerURIConstants").MESSAGE_REQUESTS_PATH);break}if(n.detailView===c("MessengerView").DETAIL.PAYTHREAD){j(o,c("MessengerURIConstants").PAYMENT_PAY_PATH);if(n.threadKey)o.addQueryData("id",n.threadKey)}else if(n.detailView===c("MessengerView").DETAIL.PAYFRIENDPICKER)j(o,c("MessengerURIConstants").PAYMENT_PAY_PATH);else if(n.detailView===c("MessengerView").DETAIL.COMPOSE)j(o,c("MessengerURIConstants").COMPOSE_SUBPATH);else if(n.threadKey)if(n.masterView===c("MessengerView").MASTER.PAYMENT){i(o,c("MessengerURIConstants").THREAD_PREFIX+n.threadKey);delete n.extraQueryParams.id;delete n.extraQueryParams.a;delete n.extraQueryParams.m}else j(o,c("MessengerURIConstants").THREAD_PREFIX+n.threadKey);else if(n.masterView===c("MessengerView").MASTER.PAYMENT){i(o,"");delete n.extraQueryParams.id;delete n.extraQueryParams.a;delete n.extraQueryParams.m}else j(o,"");if(n.extraQueryParams)o.addQueryData(n.extraQueryParams);if(c("MercuryFilters").isSupportedFilter(n.filter))o.addQueryData({filter:n.filter});if(n.query!=null){var p;o.addQueryData((p={},p[n.masterView===c("MessengerView").MASTER.SEARCH?"qa":"q"]=n.query,p))}if(n.threadIDs)o.addQueryData({threadIDs:JSON.stringify(n.threadIDs)});if(n.mid)o.addQueryData({mid:n.mid});return o},deserialize:function m(n){var o={},p=n.getPath();if(c("CurrentEnvironment").facebookdotcom&&!p.startsWith(c("MessengerURIConstants").FACEBOOK_PREFIX))o.notMessenger=true;var q=p.replace(c("MessengerURIConstants").FACEBOOK_PREFIX,""),r=void 0,s=n.getQueryData(),t=s.filter,u=s.mid,v=s.q,w=s.qa,x=s.threadIDs,y=babelHelpers.objectWithoutProperties(s,["filter","mid","q","qa","threadIDs"]);try{r=JSON.parse(x)}catch(z){o.threadIDs=null}if(r)o.threadIDs=r.filter(function(B){return c("MercuryIDs").isValidThreadID(B)});if(q.match("^"+c("MessengerURIConstants").GROUPS_PATH))o.masterView=c("MessengerView").MASTER.GROUPS;else if(q.match("^"+c("MessengerURIConstants").PEOPLE_PATH))o.masterView=c("MessengerView").MASTER.PEOPLE;else if(q.match("^"+c("MessengerURIConstants").SUPPORT_PATH))o.masterView=c("MessengerView").MASTER.SUPPORT;else if(q.match("^"+c("MessengerURIConstants").PAYMENT_PATH))o.masterView=c("MessengerView").MASTER.PAYMENT;else if(w)o.masterView=c("MessengerView").MASTER.SEARCH;else o.masterView=c("MessengerView").MASTER.RECENT;if(q.match("^"+c("MessengerURIConstants").FILTERED_REQUESTS_PATH))o.folder=c("MessagingTag").OTHER;else if(q.match("^"+c("MessengerURIConstants").ARCHIVED_PATH))o.folder=c("MessagingTag").ACTION_ARCHIVED;else if(q.match("^"+c("MessengerURIConstants").MESSAGE_REQUESTS_PATH))o.folder=c("MessagingTag").PENDING;else o.folder=c("MessagingTag").INBOX;if(q.match(c("MessengerURIConstants").COMPOSE_SUBPATH+h))o.detailView=c("MessengerView").DETAIL.COMPOSE;else if(q.match("^"+c("MessengerURIConstants").PAYMENT_PATH+c("MessengerURIConstants").PAYMENT_PAY_PATH))if(y&&y.id){o.threadKey=y.id;o.detailView=c("MessengerView").DETAIL.PAYTHREAD}else o.detailView=c("MessengerView").DETAIL.PAYFRIENDPICKER;else{var A=l(q);if(A){o.threadKey=A;o.detailView=c("MessengerView").DETAIL.THREAD}}if(c("MercuryFilters").isSupportedFilter(t))o.filter=t;else o.filter=c("MercuryFilters").ALL;o.mid=u;o.query=w||v;o.extraQueryParams=y;if(o.masterView===c("MessengerView").MASTER.SUPPORT)return c("MessengerStateProcessor").supportInboxPostprocess(o);return c("MessengerStateProcessor").postprocess(o)}};function l(m){var n=m.match(c("MessengerURIConstants").THREAD_PREFIX+"([^/]+)"+h);return n&&decodeURIComponent(n[1])}f.exports=k}),null);
__d("MessengerActions",["invariant","MercuryIDs","MessengerDispatcher","MessengerURISerializer","MercuryTypeaheadConstants","MessengerView","URI","goURI","keyMirror"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("keyMirror")({CANCEL_FILE_UPLOAD:null,EMPTY_FILES:null,LINK_PREVIEW:null,LOADED_SHARE_DATA:null,LOADING_SHARE_DATA:null,REMOVE_SHARE_PREVIEW:null,PREPARE_FILES_FOR_SEND:null,REPLACE_STATE:null,SELECT_THREAD:null,UPDATE_MDOT_ME:null,UPDATE_THREAD_TAG:null,UPLOAD_FILE_FAILED:null,UPLOADED_FILE:null}),j={Types:i,changeDetailView:function m(n){l(function(o){if(o.detailView!==n)return{detailView:n};return null})},changeMasterView:function m(n){l(function(o){if(o.masterView!==n){var p={masterView:n};if(o.masterView===c("MessengerView").MASTER.SEARCH)p.query=undefined;return p}return null})},selectAggregation:function m(n){l(function(o){return{detailView:c("MessengerView").MASTER.RECENT,threadIDs:n,mid:null}})},selectThread:function m(n,o){if(o===c("MercuryTypeaheadConstants").MEETING_ROOM_PAGE_TYPE){!!n||h(0);var p=c("MercuryIDs").getUserIDFromThreadID(n);!!p||h(0);var q=new(c("URI"))(),r=q.getQualifiedURI().getSubdomain();q.setDomain("facebook.com").setSubdomain(r).setPath("/"+p).setProtocol("https");window.open(q,"_blank");return}c("MessengerDispatcher").dispatch({type:i.SELECT_THREAD,threadID:n});l(function(s){if(s.activeThreadID!==n)return{activeThreadID:n,detailView:c("MessengerView").DETAIL.THREAD,mid:null};return null})},changeState:function m(n){c("MessengerDispatcher").dispatch({type:i.REPLACE_STATE,nextState:n})},changeMDotMeReferral:function m(){var n=arguments.length<=0||arguments[0]===undefined?null:arguments[0],o=arguments.length<=1||arguments[1]===undefined?null:arguments[1];c("MessengerDispatcher").dispatch({type:j.Types.UPDATE_MDOT_ME,refCode:n,refThreadID:o})},changeThreadTag:function m(){var n=arguments.length<=0||arguments[0]===undefined?null:arguments[0],o=arguments.length<=1||arguments[1]===undefined?null:arguments[1];c("MessengerDispatcher").dispatch({type:j.Types.UPDATE_THREAD_TAG,messagingTags:n,threadID:o})},changeFolder:function m(n){l(function(o){if(o.folder!==n)return{folder:n};return null})},changeFilter:function m(n){l(function(o){if(o.filter!==n)return{filter:n};return null})},changeQuery:function m(n){l(function(o){if(o.query!==n)return{query:n};return null})},changeQueryAll:function m(n){l(function(o){if(o.queryAll!==n)return{query:n,masterView:c("MessengerView").MASTER.SEARCH};return null})},changeMid:function m(n){l(function(o){if(o.mid!==n)return{mid:n};return null})},changeID:function m(n){l(function(o){if(o.extraQueryParams.id!==n)return{extraQueryParams:babelHelpers["extends"]({},o.extraQueryParams,{id:n})};return null})},prepareFilesForSend:function m(n,o){if(!n)return;c("MessengerDispatcher").dispatch({type:j.Types.PREPARE_FILES_FOR_SEND,threadID:n,files:o})},uploadedFile:function m(n,o,p){if(!n)return;c("MessengerDispatcher").dispatch({type:j.Types.UPLOADED_FILE,threadID:n,uploadID:o,payload:p})},cancelFileUpload:function m(n,o){if(!n)return;c("MessengerDispatcher").dispatch({type:j.Types.CANCEL_FILE_UPLOAD,threadID:n,uploadID:o})},uploadFileFailed:function m(n,o){if(!n)return;c("MessengerDispatcher").dispatch({type:j.Types.UPLOAD_FILE_FAILED,threadID:n,uploadID:o})},cleanFiles:function m(n){if(!n)return;c("MessengerDispatcher").dispatch({type:j.Types.EMPTY_FILES,threadID:n})},loadingPreview:function m(n,o){c("MessengerDispatcher").dispatch({type:j.Types.LINK_PREVIEW,threadID:n,match:o})},loadingShareData:function m(n){c("MessengerDispatcher").dispatch({type:j.Types.LOADING_SHARE_DATA,threadID:n})},loadedShareData:function m(n,o){c("MessengerDispatcher").dispatch({type:j.Types.LOADED_SHARE_DATA,threadID:n,attachmentData:o})},removeSharePreview:function m(n){c("MessengerDispatcher").dispatch({type:j.Types.REMOVE_SHARE_PREVIEW,threadID:n})}};function k(m,n){return m.detailView==null}function l(m){var n=c("MessengerURISerializer").deserialize(new(c("URI"))(window.location.href)),o=m(n),p=k(n,o);if(o)c("goURI")(c("MessengerURISerializer").serialize(Object.assign(n,o)),false,p)}f.exports=j}),null);