if (self.CavalryLogger) { CavalryLogger.start_js(["2Loi7"]); }

__d("messengerInitialDataTransformerRe",["bs_array","bs_caml_array","MercuryThreadlistConstants","messengerGraphQLThreadFetcherRe","messengerGraphQLThreadlistFetcherRe"],(function a(b,c,d,e,f,g){"use strict";function h(i){var j=i.viewer,k=i.is_page,l=i.additional_participant,m=l==null?[]:c("bs_array").map(c("messengerGraphQLThreadlistFetcherRe").transformParticipant,l.nodes),n=i.thread_list,o=n==null?null:c("messengerGraphQLThreadlistFetcherRe").transform(j,[{limit:c("MercuryThreadlistConstants").WEBMESSENGER_THREAD_COUNT+1|0,folder:"inbox",timestamp:null,offset:0,filter:null}],+k,[n]),p=i.current_thread,q;if(p==null)q=null;else{var r=p.message_thread;q=r==null?null:c("messengerGraphQLThreadFetcherRe").transformThread(j,r,+k)}var s=o==null?[[],[],{},[],[]]:[o.ordered_threadlists,o.threads,o.roger,o.participants,o.delivery_receipts],t=s[1],u=i.thread_key,v=u==null?t.filter(function(x){return+(x.unread_count===0)}):[],w=v.length?c("bs_caml_array").caml_array_get(v,0).thread_fbid:null;if(!(q==null))t.push(q);return[{ordered_threadlists:s[0],threads:t,roger:s[2],participants:s[3].concat(m),delivery_receipts:s[4],payload_source:"server_initial_data"},w]}g.transform=h}),null);