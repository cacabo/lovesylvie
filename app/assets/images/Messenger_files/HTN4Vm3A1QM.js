if (self.CavalryLogger) { CavalryLogger.start_js(["zGMV3"]); }

__d("MessengerDecorator",["cssVar","cx","BootloadedComponent.react","CurrentUser","JSResource","MercuryAttachment","MercuryConfig","MercuryMessageActions","MercuryMessageCustomizations","MercuryTagHelper","MessageBorderType","MessageCustomizationType","MessagingFlowerBorder.react","MessagingGiftWrap.react","MessagingGiftWrapConstants","MessengerEnvironment","MessengerReactions.react","React","QE2Logger"],(function a(b,c,d,e,f,g,h,i){"use strict";var j=function j(r){var s=r.attachments&&r.attachments.length===1&&r.attachments[0];if(!s)return false;if(c("MercuryAttachment").isPhotoGroupAttachment(s))return true;if(c("MercuryAttachment").isFileAttachment(s)){c("QE2Logger").logExposureForUser("messenger_chat_allow_forward_for_shared_file");if(c("MercuryConfig").MessengerForwardButtonForSharedFilesQE&&s.message_file_fbid)return true}return false},k=function k(r){var s=[],t=[];r.attachments.forEach(function(u){if(u.metadata&&u.metadata.fbid){s.push(u.metadata.fbid.toString());t.push(u.attach_type.toString())}if(c("MercuryAttachment").isFileAttachment(u)&&u.message_file_fbid)if(c("MercuryConfig").MessengerForwardButtonForSharedFilesQE){s.push(u.message_file_fbid);t.push(u.attach_type)}});return{ids:s,types:t}},l=[{name:"GiftWrap",check:function r(s){var t=function t(v){return c("MercuryTagHelper").get(v,c("MessagingGiftWrapConstants").TAG_PREFIX)===c("MessagingGiftWrapConstants").VALENTINES_GIFT},u=function u(v){return!!c("MercuryTagHelper").get(v,c("MessagingGiftWrapConstants").UNWRAPPED_TAG)};return!!(s.tags&&t(s.tags)&&!u(s.tags))},render:function r(s,t){return c("React").createElement(c("MessagingGiftWrap.react"),{key:"giftwrap",onUnwrap:function u(){var v="2500ms",w=parseInt(v.substring(0,v.length-2),10);setTimeout(function(){return c("MercuryMessageActions").get().unwrap(s)},w)}})},getAdditionalClassNames:function r(){return null}},{name:"FlowerBorder",check:function r(s){return c("MercuryConfig").WWWMessengerFlowerBorderViewer&&c("MercuryMessageCustomizations").getCustomizationValue(s,c("MessageCustomizationType").BORDER)===c("MessageBorderType").FLOWERS},render:function r(s,t){if(c("MessengerEnvironment").messengerui)return c("React").createElement(c("MessagingFlowerBorder.react"),{offset:-10,key:"giftwrap:"+s.message_id});return c("React").createElement(c("MessagingFlowerBorder.react"),{key:"giftwrap:"+s.message_id})},getAdditionalClassNames:function r(){if(!c("MessengerEnvironment").messengerui)return"_337n";return null}},{name:"Reactions",check:function r(s,t){var u=!!(s.reactions&&Object.keys(s.reactions).length>0),v=!!(!t&&j(s));return u||v},render:function r(s,t,u){return c("React").createElement(c("MessengerReactions.react"),{isFromViewer:t,key:s.message_id+"-reactions",message:s,renderQuickAdd:j(s)&&!t,participants:u&&u.participants})},getAdditionalClassNames:function r(){return"_5z-5"}}],m=[],n=[{name:"ViewerMentioned",check:function r(s){return!!(c("MercuryConfig").MentionsReply&&s.profile_ranges&&s.profile_ranges.some(function(t){return t.id===c("CurrentUser").getID()}))},render:function r(s,t,u){var v=u?u.thread?u.thread.custom_color:u.threadCustomColor||u.customColor:undefined;return c("React").createElement(c("BootloadedComponent.react"),{key:"mention-reply:"+s.message_id,bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("JSResource")("MessengerReplyToMention.react").__setRef("MessengerDecorator"),message:s,color:v})},getAdditionalClassNames:function r(){return"_aol"}}],o=[{name:"MontageReply",check:function r(s){if(!c("MercuryConfig").MontageThreadViewer)return false;var t=s.montage_reply_data&&s.montage_reply_data.message_id;return!!t},render:function r(s,t){var u=s.montage_reply_data&&s.montage_reply_data.message_id,v=s.montage_reply_data&&s.montage_reply_data.reply_action;return c("React").createElement(c("BootloadedComponent.react"),{key:"montagereply:"+s.message_id,bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("JSResource")("MontageReplyDecoratorContainer.react").__setRef("MessengerDecorator"),isFromViewer:t,messageID:u,replyAction:v,replyAuthorID:s.author,threadID:s.thread_id})},getAdditionalClassNames:function r(){return null}}],p=[{name:"ForwardImages",check:function r(s){return j(s)},render:function r(s,t){var u=k(s),v=u.ids,w=u.types;return c("React").createElement(c("BootloadedComponent.react"),{key:"forwardimages:"+s.message_id,bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("MessengerEnvironment").messengerui?c("JSResource")("MessengerPhotoForwardButton.react").__setRef("MessengerDecorator"):c("JSResource")("ChatPhotoForwardButton.react").__setRef("MessengerDecorator"),attachmentIDs:v,attachmentTypes:w,isFromViewer:t})},getAdditionalClassNames:function r(){return"_ylc"}},{name:"ReactionPrompt",check:function r(s){return!j(s)},render:function r(s,t,u){return c("React").createElement(c("BootloadedComponent.react"),{key:"reactionprompt:"+s.message_id,bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("JSResource")("MessengerReactionsPrompt.react").__setRef("MessengerDecorator"),message:s,messageIsSelected:u&&u.messageIsSelected,onShowMenu:u&&u.onShowMenu})},getAdditionalClassNames:function r(){return null}},{name:"MessageActions",check:function r(s){return c("MessengerEnvironment").messengerui},render:function r(s,t,u){return c("React").createElement(c("BootloadedComponent.react"),{key:"messageactions:"+s.message_id,bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("JSResource")("MessengerMessageActions.react").__setRef("MessengerDecorator"),message:s,isActive:u&&u.messageIsSelected,onShowMenu:u&&u.onShowMenu,includeReactions:j(s),isShowingOriginal:u&&u.isShowingOriginal,hasFormatting:u&&u.hasFormatting,onToggleOriginal:u&&u.handleToggleOriginal})},getAdditionalClassNames:function r(){return null}}],q={getBeforeDecorators:function r(){return o},getAfterDecorators:function r(){return l},getInnerDecorators:function r(){return p},getAfterExternalDecorators:function r(){return m},getInsideDecorators:function r(){return n}};f.exports=q}),null);