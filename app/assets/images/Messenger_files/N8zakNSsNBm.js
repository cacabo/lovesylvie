if (self.CavalryLogger) { CavalryLogger.start_js(["nUM2J"]); }

__d("FBRTCCapability",[],(function a(b,c,d,e,f,g){f.exports={SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3}}),null);
__d("FBRTCDeviceStatus",[],(function a(b,c,d,e,f,g){f.exports={OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10}}),null);
__d("FBRTCMediaType",[],(function a(b,c,d,e,f,g){f.exports={AUDIO:0,VIDEO:1,DATA:2}}),null);
__d("FBRTCMessageType",[],(function a(b,c,d,e,f,g){f.exports={JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,EXPERIMENT:12,P2P_PROTOCOL:13,P2P_ANSWER:14,P2P_ICE_CANDIDATE:15,CONNECT:16,APPROVAL:17}}),null);
__d("FBRTCRingType",[],(function a(b,c,d,e,f,g){f.exports={GROUP_AUDIO_CALL:0,PEER_VIDEO_CALL:1,PEER_AUDIO_CALL:2,GROUP_VIDEO_CALL:3,LIVE_STREAM:4,PEER_ESCALATED_VIDEO_CALL:5,PEER_ESCALATED_AUDIO_CALL:6}}),null);
__d("FBRTCVideoQuality",[],(function a(b,c,d,e,f,g){f.exports={LOW:0,MEDIUM:1,HIGH:2,HD:3}}),null);
__d("RTISubscriptionGate",["RTISubscriptionGateLoader"],(function a(b,c,d,e,f,g){var h=c("RTISubscriptionGateLoader").module;if(c("RTISubscriptionGateLoader").gkUseIcebreaker)h=new h(c("RTISubscriptionGateLoader").icebreakerWhitelist);f.exports=h}),null);
__d("intlSummarizeNumber",["fbt","formatNumber"],(function a(b,c,d,e,f,g,h){function i(j,k){var l=k===undefined?0:k,m=k===undefined?1:k;j=parseFloat(j.toFixed(l));if(Math.abs(j)<1e3)return c("formatNumber")(j,l);j=parseFloat((j/1e3).toFixed(m));if(Math.abs(j)<1e3)return String(h._("{number}K",[h.param("number",c("formatNumber")(j,k===undefined?j%1&&1:k))]));j=parseFloat((j/1e3).toFixed(m));if(Math.abs(j)<1e3)return String(h._("{number}M",[h.param("number",c("formatNumber")(j,k===undefined?j%1&&1:k))]));j=parseFloat((j/1e3).toFixed(m));return String(h._("{number}B",[h.param("number",c("formatNumber")(j,k===undefined?j%1&&1:k))]))}f.exports=i}),null);
__d("Facepile.react",["cx","fbt","ix","intlSummarizeNumber","joinClasses","HovercardLink","Image.react","Link.react","List.react","React"],(function a(b,c,d,e,f,g,h,i,j){var k=c("React").PropTypes,l={small:24,medium:32,large:50},m=c("React").createClass({displayName:"Facepile",defaultProps:{moreColor:"blue",moreCount:0,showHovercard:false,tooltipPosition:"above",showToolTip:true,spacing:"none"},propTypes:{className:k.string,moreColor:k.oneOf(["blue","gray"]),moreCount:k.number,moreDialogLink:k.string,morePageLink:k.string,numFaces:k.number,onFaceClick:k.func,onComponentDidMount:k.func,profiles:k.arrayOf(k.shape({URL:k.any,name:k.node.isRequired,uniqueID:k.any.isRequired,profilePicURI:k.any.isRequired})).isRequired,showHovercard:k.bool,size:k.oneOf([28,"small","medium","large"]).isRequired,spacing:k.oneOf(["none","small","medium","large"]),showToolTip:k.bool,tooltipPosition:k.oneOf(["above","below","left","right"])},_onFaceClick:function n(o,p){if(this.props.onFaceClick)this.props.onFaceClick(o,p)},componentDidMount:function n(){if(this.props.onComponentDidMount)this.props.onComponentDidMount()},getPicSize:function n(){return l[this.props.size]||this.props.size},renderFace:function n(o,p){var q=this.getPicSize(),r=c("HovercardLink").constructEndpoint({id:o.uniqueID}).toString();return c("React").createElement("li",{className:"_43q7",key:o.uniqueID,onClick:this._onFaceClick.bind(this,o,p)},c("React").createElement(c("Link.react"),{"aria-label":o.name,className:"_2rt_ link","data-hover":!this.props.showHovercard?"tooltip":null,"data-hovercard":this.props.showHovercard?r:null,"data-ignoreclass":"_2rt_","data-tooltip-alignh":"left","data-tooltip-content":o.name,"data-tooltip-position":this.props.tooltipPosition,href:o.URL},c("React").createElement(c("Image.react"),{src:o.profilePicURI,width:q,height:q,className:"img"})))},renderMore:function n(){if(!this.props.moreCount)return null;var o=this.props.numFaces!=null&&this.props.numFaces<=this.props.profiles.length?this.props.moreCount+1:this.props.moreCount,p=c("intlSummarizeNumber")(o,0),q=p.length,r;if(o===0||this.props.size==="small"&&q>2||this.props.size===28&&q>2||this.props.size==="medium"&&q>3||this.props.size==="large"&&q>6)r=c("React").createElement(c("Image.react"),{src:j("97502")});else r="+"+p;var s;if(this.props.showToolTip===undefined||this.props.showToolTip===true)if(o===1)s=i._("1 other person");else s=i._("{num} other people",[i.param("num",o)]);var t=c("joinClasses")("_43q8 _43q7"+(q<2?" _43qa":"")+(q===2?" _43qb":"")+(q===3?" _43qd":"")+(q>3?" _43qe":"")+(this.props.moreColor==="blue"?" _49c8":"")+(this.props.moreColor==="gray"?" _49cb":""));return c("React").createElement("li",{className:t},c("React").createElement("a",{"data-hover":s?"tooltip":null,"data-tooltip-position":s?"right":null,"data-tooltip-content":s,ajaxify:this.props.moreDialogLink||this.props.morePageLink,href:this.props.morePageLink,role:"button",rel:this.props.moreDialogLink?"dialog":null},r))},render:function n(){var o=this.props.spacing||this.defaultProps.spacing,p=c("joinClasses")(this.props.className,"_43qm"+(this.props.size==28?" _3cxu":"")+(this.props.size=="small"?" _43q9":"")+(this.props.size=="medium"?" _43qc":"")+(this.props.size=="large"?" _43qf":"")+(o!=this.defaultProps.spacing?" _4nab":"")),q=this.props.numFaces==undefined?this.props.profiles:this.props.profiles.slice(0,this.props.moreCount?this.props.numFaces-1:this.props.numFaces);return c("React").createElement("div",{className:p,style:this.props.style},c("React").createElement(c("List.react"),{className:"_4cg3",direction:"horizontal",spacing:this.props.spacing||"none",border:"none"},q.map(this.renderFace),this.renderMore()))}});f.exports=m}),null);
__d("BonfireUserFetcherQuery.graphql",[],(function a(b,c,d,e,f,g){"use strict";var h=function(){var i=[{kind:"LocalArgument",name:"userId",type:"ID!",defaultValue:null}],j=[{kind:"Variable",name:"id",variableName:"userId",type:"ID!"}],k={kind:"ScalarField",alias:null,args:null,name:"id",storageKey:null},l={kind:"LinkedField",alias:null,args:null,concreteType:"BonfireUser",name:"bonfire_user",plural:false,selections:[k,{kind:"ScalarField",alias:null,args:null,name:"display_name",storageKey:null},{kind:"ScalarField",alias:null,args:null,name:"username",storageKey:null},{kind:"ScalarField",alias:null,args:null,name:"profile_picture_uri",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:i,kind:"Fragment",metadata:null,name:"BonfireUserFetcherQuery",selections:[{kind:"LinkedField",alias:null,args:j,concreteType:null,name:"node",plural:false,selections:[{kind:"InlineFragment",type:"User",selections:[k,l]}],storageKey:null}],type:"Query"},id:"1583148155077981",kind:"Batch",metadata:{},name:"BonfireUserFetcherQuery",query:{argumentDefinitions:i,kind:"Root",name:"BonfireUserFetcherQuery",operation:"query",selections:[{kind:"LinkedField",alias:null,args:j,concreteType:null,name:"node",plural:false,selections:[{kind:"ScalarField",alias:null,args:null,name:"__typename",storageKey:null},k,{kind:"InlineFragment",type:"User",selections:[l]}],storageKey:null}]},text:null}}();f.exports=h}),null);
__d("BaseGraphQLSubscription",["Banzai","BanzaiLogger","ChannelClientID","CurrentLocale","CurrentUser","GraphQLSubscriptionsConfig","RTISubscriptionGate","URI"],(function a(b,c,d,e,f,g){var h=1e4,i={subscribe:function j(k,l){var m={transformContext:JSON.stringify(this._getTransformContext(k))},n=this._getQueryParameters(k);this._logEvent("client_subscribe",n);return c("RTISubscriptionGate").subscribe(this._getTopic(k),function(o){this._logEvent("receivepayload",n);l(JSON.parse(o.payload))}.bind(this),m,null,function(){this._logEvent("client_unsubscribe",n)}.bind(this))},subscribeWithIcebreaker_EXPERIMENTAL:function j(k,l,m){var n=new(c("URI"))("https://streaming-graph.facebook.com/gqls_bore");n.setQueryData({access_token:m});var o=this._getTopic(k),p={topic:o,locale:c("CurrentLocale").get(),queryID:this._getQueryID(),serializedQueryParameters:JSON.stringify(this._getQueryParameters(k))};n.addQueryData(p);var q=new EventSource(n.toString(),{withCredentials:true});q.addEventListener("message",function(r){l(JSON.parse(JSON.parse(r.data).payload))},false);return{getContext:function r(){return p},unsubscribe:function r(){return q.close()}}},_getTransformContext:function j(k){var l=155160167952447;return{viewerID:c("CurrentUser").getID(),appID:l,locale:c("CurrentLocale").get(),queryID:this._getQueryID(),serializedQueryParameters:JSON.stringify(this._getQueryParameters(k))}},_logEvent:function j(k,l){if(c("Banzai").isEnabled("gqls_web_logging")){var m=c("GraphQLSubscriptionsConfig").shouldAlwaysLog?1:h;if(Math.random()*m<1)c("BanzaiLogger").log("GraphQLSubscriptionsLoggerConfig",{clienttime:Date.now()/1e3,client_sample_weight:m,event:k,mechanism:"skywalker",query_id:parseInt(this._getQueryID(),10),query_params:l,session_id:c("ChannelClientID").getID(),subscription_call:this._getSubscriptionCallName()})}}};f.exports=i}),null);
__d("WebGraphQLSubscriptionHelper",[],(function a(b,c,d,e,f,g){"use strict";f.exports={getExports:function h(i){var j=i.docID,k=i.queryID;return{getDocID:function l(){return j},getLegacyQueryID:function l(){return k}}}}}),null);
__d("RungParticipantsAddedWebGraphQLSubscription",["WebGraphQLSubscriptionHelper"],(function a(b,c,d,e,f,g){"use strict";f.exports=c("WebGraphQLSubscriptionHelper").getExports({docID:"1827255650647769",queryID:"269594620198902"})}),null);
__d("RungParticipantsAddedSubscription",["BaseGraphQLSubscription","GraphQLSubscriptionsConfig","RungParticipantsAddedWebGraphQLSubscription","uuid"],(function a(b,c,d,e,f,g){var h=babelHelpers["extends"]({},c("BaseGraphQLSubscription"),{_getTopic:function i(j){return"gqls/rung_participants_added_subscribe/call_id_"+j},_getQueryID:function i(){return c("GraphQLSubscriptionsConfig").shouldUseGraphQL2DocumentIDs?c("RungParticipantsAddedWebGraphQLSubscription").getDocID():c("RungParticipantsAddedWebGraphQLSubscription").getLegacyQueryID()},_getQueryParameters:function i(j){return{input:JSON.stringify({client_subscription_id:c("uuid")(),call_id:j})}},_getSubscriptionCallName:function i(){return"rung_participants_added_subscribe"}});f.exports=h}),null);
__d("MessengerRTCGroupCallIncomingDialog.react",["cx","fbt","Facepile.react","ImageBlock.react","immutable","MercuryIDs","MercuryParticipants","messengerDialogsRe","messengerContactImageReact","MessengerDialog.react","messengerDialogBodyReact","MessengerDialogButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","React","RungParticipantsAddedSubscription"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("messengerContactImageReact").jsComponent,m=c("messengerDialogBodyReact").jsComponent,n=400,o=5,p=50,q=function q(y,z){var A=void 0;if(y)A=z?i._("Incoming Group Video Chat"):i._("Incoming Group Call");else A=z?i._("Incoming Video Chat"):i._("Incoming Call");return A},r=function r(y,z,A){var B;if(y)B=z?i._("{caller name} started a group video chat in a group you're a member of.",[i.param("caller name",A.name)]):i._("{caller name} started a group call in a group you're a member of.",[i.param("caller name",A.name)]);else B=z?i._("{caller name} invited you to a group video chat.",[i.param("caller name",A.name)]):i._("{caller name} invited you to a group call.",[i.param("caller name",A.name)]);return B},s=function s(y){var z=y.isGroupCall,A=y.hasVideo;return c("React").createElement(c("MessengerDialogHeader.react"),null,q(z,A))},t=function t(y){var z=y.isGroupCall,A=y.hasVideo,B=y.caller,C=y.callees;return c("React").createElement(m,null,c("React").createElement(c("ImageBlock.react"),null,c("React").createElement(l,{isMessengerUser:B.is_messenger_user,size:p,src:B.big_image_src||B.image_src}),c("React").createElement("div",{className:"_2n1r"},c("React").createElement("div",{className:"_2n1s"},r(z,A,B)),c("React").createElement(c("Facepile.react"),{moreCount:Math.max(0,C.length-o),profiles:C.map(function(D){var E=D.name,F=D.fbid,G=D.big_image_src;return{name:E,uniqueID:F,profilePicURI:G}}).slice(0,o),size:"medium"}),c("React").createElement("div",{className:"_2n1t"},A?i._("Video will start as soon as you answer."):i._("The call will start as soon as you answer.")))))},u=function u(y){c("messengerDialogsRe").removeAllDialogs();y()},v=function v(y){c("messengerDialogsRe").removeAllDialogs();y()},w=function w(y,z){if(!y){c("messengerDialogsRe").removeAllDialogs();z()}};j=babelHelpers.inherits(x,c("React").Component);k=j&&j.prototype;function x(y){k.constructor.call(this,y);this.$MessengerRTCGroupCallIncomingDialog2=null;this.$MessengerRTCGroupCallIncomingDialog3()}x.prototype.componentDidMount=function(){c("MercuryParticipants").getMulti(this.props.participantIDs.map(c("MercuryIDs").getParticipantIDFromUserID),function(y){var z=c("immutable").Map(y).filter(function(A){return A.id!=this.props.callerID}.bind(this));this.$MessengerRTCGroupCallIncomingDialog1=y[this.props.callerID];this.setState({rungParticipants:z})}.bind(this))};x.prototype.$MessengerRTCGroupCallIncomingDialog3=function(){var y=this.props.conferenceName.split(":")[1];this.$MessengerRTCGroupCallIncomingDialog2=c("RungParticipantsAddedSubscription").subscribe(y,function(z){var A=z.rung_participants_added_subscribe.call.rung_participants.edges;if(A.length>this.state.rungParticipants.size){var B=A.map(function(C){var D=C.node.facebook_personal_user.id;return c("MercuryIDs").getParticipantIDFromUserID(D)}).filter(function(C){return!this.state.rungParticipants.has(C)}.bind(this));c("MercuryParticipants").getMulti(B,function(C){var D=this.state.rungParticipants.concat(C);this.setState({rungParticipants:D})}.bind(this))}}.bind(this))};x.prototype.componentWillUnmount=function(){if(!this.$MessengerRTCGroupCallIncomingDialog2)return;this.$MessengerRTCGroupCallIncomingDialog2.unsubscribe();this.$MessengerRTCGroupCallIncomingDialog2=null};x.prototype.render=function(){if(!this.$MessengerRTCGroupCallIncomingDialog1)return null;return c("React").createElement(c("MessengerDialog.react"),{layerHideOnBlur:false,shown:true,onToggle:function(y){return w(y,this.props.onIgnore)}.bind(this),width:n},c("React").createElement(s,{hasVideo:this.props.hasVideo,isGroupCall:this.props.isGroupCall}),c("React").createElement(t,{isGroupCall:this.props.isGroupCall,hasVideo:this.props.hasVideo,caller:this.$MessengerRTCGroupCallIncomingDialog1,callees:this.state.rungParticipants.valueSeq().toArray()}),c("React").createElement(c("MessengerDialogFooter.react"),null,c("React").createElement(c("MessengerDialogButton.react"),{label:i._("Ignore"),onClick:function(){return u(this.props.onIgnore)}.bind(this),type:"secondary"}),c("React").createElement(c("MessengerDialogButton.react"),{label:i._("Answer Call"),onClick:function(){return v(this.props.onAnswer)}.bind(this),type:"primary"})))};f.exports=x}),null);
__d("MessengerRTCGroupCallIncomingDialogController",["EventEmitter","FBRTCSoundController","MercuryIDs","MercuryParticipants","MessengerBrowserAlerts","messengerDialogsRe","MessengerRTCGroupCallIncomingDialog.react","MessengerRTCIncomingDialog.react","React","RTCConfig","RTCUtils","XGroupCallController","randomInt","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=7e4;h=babelHelpers.inherits(k,c("EventEmitter"));i=h&&h.prototype;function k(l,m,n,o,p,q){i.constructor.call(this);this.$MessengerRTCGroupCallIncomingDialogController1=l;this.$MessengerRTCGroupCallIncomingDialogController2=m;this.$MessengerRTCGroupCallIncomingDialogController3=n;this.$MessengerRTCGroupCallIncomingDialogController4=o;this.$MessengerRTCGroupCallIncomingDialogController5=p;this.$MessengerRTCGroupCallIncomingDialogController6=q;this.$MessengerRTCGroupCallIncomingDialogController7=null;this.$MessengerRTCGroupCallIncomingDialogController8=null;this.$MessengerRTCGroupCallIncomingDialogController9=false}k.prototype.serverInfoData=function(){return this.$MessengerRTCGroupCallIncomingDialogController6};k.prototype.showIncomingDialog=function(){var l,m=this;this.$MessengerRTCGroupCallIncomingDialogController7=c("setTimeoutAcrossTransitions")(this.$MessengerRTCGroupCallIncomingDialogController10.bind(this),j);var n=this.$MessengerRTCGroupCallIncomingDialogController1+c("randomInt")(0,4294967295).toString();c("FBRTCSoundController").playIncomingRingtone(n,this.$MessengerRTCGroupCallIncomingDialogController1,true);if(!c("RTCUtils").isGroupCall(this.$MessengerRTCGroupCallIncomingDialogController1)&&!c("RTCUtils").isMessengerCall(this.$MessengerRTCGroupCallIncomingDialogController1))c("messengerDialogsRe").showDialog(function(){return c("React").createElement(c("MessengerRTCIncomingDialog.react"),{callerID:this.$MessengerRTCGroupCallIncomingDialogController3,isVideoCall:this.$MessengerRTCGroupCallIncomingDialogController5,onAccept:function(){return this.$MessengerRTCGroupCallIncomingDialogController11()}.bind(this),onDecline:function(){return this.$MessengerRTCGroupCallIncomingDialogController12()}.bind(this)})}.bind(this));else(function(){var o=[m.$MessengerRTCGroupCallIncomingDialogController3].concat(m.$MessengerRTCGroupCallIncomingDialogController4);c("messengerDialogsRe").showDialog(function(){return c("React").createElement(c("MessengerRTCGroupCallIncomingDialog.react"),{callerID:c("MercuryIDs").getParticipantIDFromUserID(this.$MessengerRTCGroupCallIncomingDialogController3),conferenceName:this.$MessengerRTCGroupCallIncomingDialogController1,isGroupCall:c("RTCUtils").isGroupCall(this.$MessengerRTCGroupCallIncomingDialogController1),hasVideo:this.$MessengerRTCGroupCallIncomingDialogController5,onAnswer:function(){return this.$MessengerRTCGroupCallIncomingDialogController11()}.bind(this),onIgnore:function(){return this.$MessengerRTCGroupCallIncomingDialogController12()}.bind(this),participantIDs:o})}.bind(m))})();if(c("RTCConfig").BrowserNotificationGK)this.$MessengerRTCGroupCallIncomingDialogController13(this.$MessengerRTCGroupCallIncomingDialogController5)};k.prototype.$MessengerRTCGroupCallIncomingDialogController13=function(l){var m={peerID:this.$MessengerRTCGroupCallIncomingDialogController3,onNotificationClicked:this.$MessengerRTCGroupCallIncomingDialogController11.bind(this),isVideoCall:l,isGroupCall:c("RTCUtils").isGroupCall(this.$MessengerRTCGroupCallIncomingDialogController1)};c("MessengerBrowserAlerts").showRTCNotification(m,function(n){this.$MessengerRTCGroupCallIncomingDialogController8=n;if(this.$MessengerRTCGroupCallIncomingDialogController9)this.$MessengerRTCGroupCallIncomingDialogController14()}.bind(this))};k.prototype.cancel=function(){if(this.$MessengerRTCGroupCallIncomingDialogController7)clearTimeout(this.$MessengerRTCGroupCallIncomingDialogController7);c("messengerDialogsRe").removeAllDialogs();c("FBRTCSoundController").stopIncomingRingtone();if(this.$MessengerRTCGroupCallIncomingDialogController8)this.$MessengerRTCGroupCallIncomingDialogController14();this.$MessengerRTCGroupCallIncomingDialogController9=true};k.prototype.$MessengerRTCGroupCallIncomingDialogController11=function(){this.cancel();var l=c("XGroupCallController").getURIBuilder().setString("conference_name",this.$MessengerRTCGroupCallIncomingDialogController1).setInt("call_id",this.$MessengerRTCGroupCallIncomingDialogController2).setBool("has_video",this.$MessengerRTCGroupCallIncomingDialogController5).setString("server_info_data",this.$MessengerRTCGroupCallIncomingDialogController6).getURI();this.emit("answerCall",this.$MessengerRTCGroupCallIncomingDialogController1,l)};k.prototype.$MessengerRTCGroupCallIncomingDialogController12=function(){this.cancel();this.emit("ignoreCall")};k.prototype.$MessengerRTCGroupCallIncomingDialogController10=function(){this.cancel();this.emit("timeout")};k.prototype.$MessengerRTCGroupCallIncomingDialogController14=function(){if(this.$MessengerRTCGroupCallIncomingDialogController8){this.$MessengerRTCGroupCallIncomingDialogController8.close();this.$MessengerRTCGroupCallIncomingDialogController8=null}};f.exports=k}),null);
__d("MercuryParticipantListRenderer",["fbt","MercuryIDs"],(function a(b,c,d,e,f,g,h){"use strict";function i(){this.$MercuryParticipantListRenderer6=function(s){var t=this.$MercuryParticipantListRenderer5;if(t){var u=c("MercuryIDs").getUserIDFromParticipantID(s.id);if(u&&t[u])return t[u]}return this.$MercuryParticipantListRenderer2?s.short_name:s.name}.bind(this);this.$MercuryParticipantListRenderer1=false;this.$MercuryParticipantListRenderer2=false;this.$MercuryParticipantListRenderer3=false;this.$MercuryParticipantListRenderer4=0;this.$MercuryParticipantListRenderer5=null}i.prototype.renderParticipantList=function(s){var t=s.map(this.$MercuryParticipantListRenderer6);switch(t.length){case 0:return j(this.$MercuryParticipantListRenderer1);case 1:return k(t);case 2:return this.$MercuryParticipantListRenderer3?m(t):l(t);case 3:return this.$MercuryParticipantListRenderer3?o(t):n(t);default:return this.$MercuryParticipantListRenderer3?q(t,this.$MercuryParticipantListRenderer4):p(t,this.$MercuryParticipantListRenderer4)}};i.prototype.setIsNewThread=function(s){this.$MercuryParticipantListRenderer1=s;return this};i.prototype.setNameRenderer=function(s){this.$MercuryParticipantListRenderer6=s;return this};i.prototype.setUseShortName=function(s){this.$MercuryParticipantListRenderer2=s;return this};i.prototype.setNickname=function(s){this.$MercuryParticipantListRenderer5=s;return this};i.prototype.setUseAndSeparator=function(s){this.$MercuryParticipantListRenderer3=s;return this};i.prototype.setTotalParticipantCount=function(s){this.$MercuryParticipantListRenderer4=s;return this};function j(s){if(s)return h._("New Message");else return h._("No Participants")}function k(s){return s[0]}function l(s){return h._("{participant1}, {participant2}",[h.param("participant1",s[0]),h.param("participant2",s[1])])}function m(s){return h._("{participant1} and {participant2}",[h.param("participant1",s[0]),h.param("participant2",s[1])])}function n(s){return h._("{participant1}, {participant2}, {participant3}",[h.param("participant1",s[0]),h.param("participant2",s[1]),h.param("participant3",s[2])])}function o(s){return h._("{participant1}, {participant2} and {participant3}",[h.param("participant1",s[0]),h.param("participant2",s[1]),h.param("participant3",s[2])])}function p(s,t){return h._("{participant1}, {participant2}, {participant3}, {others_link}",[h.param("participant1",s[0]),h.param("participant2",s[1]),h.param("participant3",s[2]),h.param("others_link",r((t||s.length)-3))])}function q(s,t){return h._("{participant1}, {participant2} and {others_link}",[h.param("participant1",s[0]),h.param("participant2",s[1]),h.param("others_link",r((t||s.length)-2))])}function r(s){if(s>1)return h._({"*":"{others_count} others"},[h.param("others_count",s,[0])]);else return h._("1 other")}f.exports=i}),null);
__d("MercuryThreadTitle.react",["fbt","MercuryIDs","MessengerTextWithEmoticons.react","MercuryParticipantListRenderer","MercuryParticipants","React","TextWithEmoticons.react"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("React").PropTypes,j=c("React").createClass({displayName:"MercuryThreadTitle",propTypes:{isNewThread:i.bool,thread:i.object.isRequired,viewer:i.string.isRequired,showUnreadCount:i.bool,useShortName:i.bool,useAndSeparator:i.bool},getDefaultProps:function k(){return{isNewThread:false,showUnreadCount:false,useShortName:false,useAndSeparator:false}},getInitialState:function k(){return{participantNames:""}},componentDidMount:function k(){this._renderParticipantsList(this.props)},componentWillReceiveProps:function k(l){this._renderParticipantsList(l)},render:function k(){return c("React").createElement("span",{className:this.props.className},this.props.thread.name?this._renderThreadTitle():this.state.participantNames,this.props.children)},getTitle:function k(){return this.state.participantNames},_renderThreadTitle:function k(){var l=this.props.thread,m=c("React").createElement(c("MessengerTextWithEmoticons.react"),{renderEmoticons:true,renderEmoji:true,text:l.name});if(!l.unread_count||!this.props.showUnreadCount)return m;return this._renderTitleWithUnreadCount(m,l.unread_count)},_renderParticipantsList:function k(l){if(l.thread.name)return;this.setState({participantNames:""});var m=c("MercuryIDs").getParticipantIDFromUserID(l.viewer),n=l.thread.participants||[];if(n.length>1)n=n.filter(function(o){return o!=m});c("MercuryParticipants").getMulti(n,function(o){if(!this.isMounted())return;var p=n.map(function(s){return o[s]}),q=l.thread.custom_nickname?{}:null,r=c("MessengerTextWithEmoticons.react");if(q)for(var s in l.thread.custom_nickname)q[s]=c("React").createElement(r,{renderEmoticons:true,renderEmoji:true,text:l.thread.custom_nickname[s]});var t=new(c("MercuryParticipantListRenderer"))().setUseShortName(l.useShortName).setUseAndSeparator(l.useAndSeparator).setIsNewThread(l.isNewThread).setNickname(q).renderParticipantList(p),u=l.showUnreadCount&&l.thread.unread_count?this._renderTitleWithUnreadCount(t,l.thread.unread_count):t;this.setState({participantNames:u})}.bind(this))},_renderTitleWithUnreadCount:function k(l,m){return h._("{conversation-title} ({unread-count})",[h.param("conversation-title",l),h.param("unread-count",m)])}});f.exports=j}),null);
__d("RTCCallTitle.react",["immutable","MercuryIDs","MercuryParticipantListRenderer","React"],(function a(b,c,d,e,f,g){"use strict";var h=function h(i){var j=i.viewer,k=i.participants,l=i.className,m=c("MercuryIDs").getParticipantIDFromUserID(j),n=Object.keys(k.toJS());if(n.length>1)n=n.filter(function(q){return q!=m});var o=n.map(function(q){return k.get(q)}),p=new(c("MercuryParticipantListRenderer"))().setUseShortName(false).setUseAndSeparator(false).renderParticipantList(o);return c("React").createElement("span",{className:l},p)};f.exports=h}),null);
__d("MessengerRTCGroupCallThreadRow.react",["cx","fbt","MercuryParticipantsImage.react","MercuryThreadTitle.react","messengerProfileImageWrapperReact","messengerThreadImageReact","React","RTCCallTitle.react"],(function a(b,c,d,e,f,g,h,i){"use strict";var j=c("messengerProfileImageWrapperReact").jsComponent,k=c("messengerThreadImageReact").jsComponent,l=function l(p){var q=p.displayAddMemberWarning,r=p.participants,s=p.thread,t=p.viewerID;return c("React").createElement("div",{className:"_5y31"},c("React").createElement(k,{className:"_5y32",participants:r,thread:s,viewer:t}),c("React").createElement("div",{className:"_5y34"},c("React").createElement(c("MercuryThreadTitle.react"),{className:"_5y37",thread:s,viewer:t}),c("React").createElement(n,{displayAddMemberWarning:q})))},m=function m(p){var q=p.displayAddMemberWarning,r=p.participants,s=p.thread,t=p.viewerID;return c("React").createElement("div",{className:"_5y31"},c("React").createElement(j,{className:"_5y32",showBadge:false},c("React").createElement(c("MercuryParticipantsImage.react"),{participants:Object.keys(r.toJS()),size:50})),c("React").createElement("div",{className:"_5y34"},c("React").createElement(c("RTCCallTitle.react"),{className:"_5y37",participants:r,viewer:t}),c("React").createElement(n,{displayAddMemberWarning:q})))},n=function n(p){var q=p.displayAddMemberWarning;return q?c("React").createElement("div",{className:"_1apf"},i._("People you add to this group video will see previous messages in this conversation.")):null},o=function o(p){var q=p.thread,r=babelHelpers.objectWithoutProperties(p,["thread"]);return q?c("React").createElement(l,babelHelpers["extends"]({thread:q},r)):c("React").createElement(m,babelHelpers["extends"]({thread:q},r))};f.exports=o}),null);
__d("MessengerRTCGroupCallUnsupportedBrowserDialog.react",["fbt","Link.react","MessengerDialog.react","messengerDialogBodyReact","MessengerDialogButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","React","UserAgent"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("messengerDialogBodyReact").jsComponent,j=function j(n){var o=n.hasVideo,p=n.onUnmount;return c("React").createElement(c("MessengerDialog.react"),{onToggle:p},c("React").createElement(c("MessengerDialogHeader.react"),null,k(o)),c("React").createElement(i,null,l(o)),c("React").createElement(c("MessengerDialogFooter.react"),null,c("React").createElement(c("MessengerDialogButton.react"),{label:h._("OK"),onClick:p,type:"primary"})))};function k(n){return n?h._("Switch Browsers to Make Group Video Chats"):h._("Switch Browsers to Make Group Calls")}function l(n){return n?h._("Unfortunately, our group calling feature doesn't support {browser name, i.e. Internet Explorer or Safari} yet. To make a group video chat, open in {link to install chrome}.",[h.param("browser name, i.e. Internet Explorer or Safari",m()),h.param("link to install chrome",c("React").createElement(c("Link.react"),{href:"https://www.google.com/chrome/index.html",target:"_blank"},"Google Chrome"))]):h._("Unfortunately, our group calling feature doesn't support {browser name, i.e. Internet Explorer or Safari} yet. To make a group call, open in {link to install chrome}.",[h.param("browser name, i.e. Internet Explorer or Safari",m()),h.param("link to install chrome",c("React").createElement(c("Link.react"),{href:"https://www.google.com/chrome/index.html",target:"_blank"},"Google Chrome"))])}function m(){if(c("UserAgent").isBrowser("Firefox"))return h._("Firefox");else if(c("UserAgent").isBrowser("IE"))return h._("Internet Explorer");else if(c("UserAgent").isBrowser("Safari"))return h._("Safari");else return h._("your browser")}f.exports=j}),null);
__d("MessengerRTCGroupCallUnsupportedBrowserDialogController",["DOM","MessengerRTCGroupCallUnsupportedBrowserDialog.react","React","ReactDOM"],(function a(b,c,d,e,f,g){"use strict";var h={_container:c("DOM").create("div"),render:function i(j){var k=j.hasVideo;c("ReactDOM").render(c("React").createElement(c("MessengerRTCGroupCallUnsupportedBrowserDialog.react"),{hasVideo:k,onUnmount:function(){return this.unmount()}.bind(this)}),this._container)},unmount:function i(){c("ReactDOM").unmountComponentAtNode(this._container)}};f.exports=h}),null);
__d("BonfireUserFetcher",["regeneratorRuntime","Promise","LogHistory","RelayFBEnvironment","RTCUser","immutable","RelayModern","idx","nullthrows","BonfireUserFetcherQuery.graphql"],(function a(b,c,d,e,f,g){"use strict";var h,i=c("immutable").Set,j=c("immutable").List,k=c("immutable").Map,l=c("RelayModern").graphql,m=c("RelayModern").fetchQuery;function n(u){return c("regeneratorRuntime").async(function v(w){while(1)switch(w.prev=w.next){case 0:w.prev=0;w.next=3;return c("regeneratorRuntime").awrap(m(c("RelayFBEnvironment"),h||(h=function h(){return c("BonfireUserFetcherQuery.graphql")}),{userId:u}));case 3:return w.abrupt("return",w.sent);case 6:w.prev=6;w.t0=w["catch"](0);c("LogHistory").getInstance("bonfire_fetcher").error("fetch_error",JSON.stringify(w.t0));throw w.t0;case 10:case"end":return w.stop()}},null,this,[[0,6]])}function o(u){var v,w,x,y,z,A=u.node,B=(v=A)!=null?(v=v.bonfire_user)!=null?v.id:v:v,C=(w=A)!=null?w.id:w;if(!B||!C)return null;var D=c("nullthrows")((x=A)!=null?(x=x.bonfire_user)!=null?x.display_name:x:x),E=c("nullthrows")((y=A)!=null?(y=y.bonfire_user)!=null?y.username:y:y),F=c("nullthrows")((z=A)!=null?(z=z.bonfire_user)!=null?z.profile_picture_uri:z:z);return new(c("RTCUser"))({FBID:C,profileUrl:null,profilePictureUrl:F,isMessengerUser:false,userName:D,userShortName:E})}function p(u){var v,w,x,y,z,A=u.node,B=(v=A)!=null?(v=v.bonfire_user)!=null?v.id:v:v,C=(w=A)!=null?w.id:w;if(!B||!C)return null;var D=c("nullthrows")((x=A)!=null?(x=x.bonfire_user)!=null?x.display_name:x:x),E=c("nullthrows")((y=A)!=null?(y=y.bonfire_user)!=null?y.username:y:y),F=c("nullthrows")((z=A)!=null?(z=z.bonfire_user)!=null?z.profile_picture_uri:z:z);return{accepts_messenger_user_feedback:false,big_image_src:F,employee:false,fbid:C,gender:0,href:null,id:"fbid:"+C,image_src:F,is_business_enabled:null,is_employee_away:null,is_friend:null,is_messenger_user:null,is_messenger_platform_bot:null,is_parties_user:true,is_verified:null,name:D,short_name:D,type:null,vanity:E,timezone:null,personal_id:null,work_id:null}}function q(u){var v;return c("regeneratorRuntime").async(function w(x){while(1)switch(x.prev=x.next){case 0:x.next=2;return c("regeneratorRuntime").awrap(n(u));case 2:v=x.sent;return x.abrupt("return",p(v));case 4:case"end":return x.stop()}},null,this)}function r(u){var v,w,x,y;return c("regeneratorRuntime").async(function z(A){while(1)switch(A.prev=A.next){case 0:v=j(u);w=v.map(function(B){return q(B)}).toArray();A.next=4;return c("regeneratorRuntime").awrap(c("Promise").all(w));case 4:x=A.sent;y=k(v.zip(x));return A.abrupt("return",y);case 7:case"end":return A.stop()}},null,this)}function s(u){var v;return c("regeneratorRuntime").async(function w(x){while(1)switch(x.prev=x.next){case 0:x.next=2;return c("regeneratorRuntime").awrap(q(u));case 2:v=x.sent;return x.abrupt("return",c("nullthrows")(v));case 4:case"end":return x.stop()}},null,this)}function t(u){var v;return c("regeneratorRuntime").async(function w(x){while(1)switch(x.prev=x.next){case 0:x.next=2;return c("regeneratorRuntime").awrap(n(u));case 2:v=x.sent;return x.abrupt("return",o(v));case 4:case"end":return x.stop()}},null,this)}f.exports={fetchAllParticipants:r,fetchParticipant:s,fetchUser:t}}),null);
__d("FBRTCMultiwayMessage",["ChannelManager","CurrentUser","FBRTCMessageType","RTCUtils"],(function a(b,c,d,e,f,g){c("ChannelManager").startChannelManager();function h(i){"use strict";this.$FBRTCMultiwayMessage1=i}h.prototype.isRequest=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header.responseStatusCode==null};h.prototype.isType=function(i){"use strict";return this.header().type==i};h.prototype.transactionId=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header.transactionId};h.prototype.conferenceName=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header.conferenceName};h.prototype.serverInfoData=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header.serverInfoData};h.prototype.message=function(){"use strict";return this.$FBRTCMultiwayMessage1};h.prototype.endpoint=function(){"use strict";return this.$FBRTCMultiwayMessage1.endpoint};h.prototype.header=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.header};h.prototype.body=function(){"use strict";return this.$FBRTCMultiwayMessage1.jsonPayload.body};h.prototype.incrementRetryCount=function(){"use strict";this.$FBRTCMultiwayMessage1.jsonPayload.header.retryCount++};h.prototype.ringRequest=function(){"use strict";return this.isRequest()&&this.isType(c("FBRTCMessageType").RING)?this.body().ringRequest:null};h.prototype.dismissRequest=function(){"use strict";return this.isRequest()&&this.isType(c("FBRTCMessageType").DISMISS)?this.body().dismissRequest:null};h.prototype.serverMediaUpdateRequest=function(){"use strict";return this.isRequest()&&this.isType(c("FBRTCMessageType").SERVER_MEDIA_UPDATE)?this.body().serverMediaUpdateRequest:null};h.prototype.conferenceStateRequest=function(){"use strict";return this.isRequest()&&this.isType(c("FBRTCMessageType").CONFERENCE_STATE)?this.body().conferenceStateRequest:null};h.prototype.createResponse=function(i,j){"use strict";var k={endpoint:{appId:"229895473858072",deviceId:c("ChannelManager").getCompleteConfig().sessionID,userId:c("CurrentUser").getID()},jsonPayload:{header:c("RTCUtils").createResponseHeader(this.header(),i),body:j||{}}};return new h(k)};f.exports=h}),null);
__d("XGroupCallSendMessageController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groupcall/sendmessage/",{webrtc_fbtrace:{type:"Int"}})}),null);
__d("RTCMessageSender",["Promise","CurrentUser","XGroupCallSendMessageController","SiteData","Fbtrace","AsyncRequest"],(function a(b,c,d,e,f,g){var h=6e3;function i(){"use strict"}i.prototype.send=function(j){"use strict";return new(c("Promise"))(function(k,l){var m=j.jsonPayload.header.conferenceName,n={conference_name:m,user_id:c("CurrentUser").getID(),message:j,app_id:256281040558,app_version:String(c("SiteData").client_revision||"dev"),op:"RTCMessageSender.send",policy:"WebRTC"},o=c("Fbtrace").requestReceive("browser",String(c("SiteData").client_revision||"dev"),n),p=c("XGroupCallSendMessageController").getURIBuilder().setInt("webrtc_fbtrace",o.isOn()?1:0).getURI();c("Fbtrace").withDefaultNode(o,function(){var q=new(c("AsyncRequest"))(p).setMethod("POST").setData({message:JSON.stringify(j)}).setAllowCrossPageTransition(true).setHandler(function(r){k(r)}).setErrorHandler(function(r){var s=r.getErrorDescription(),t=Error(s!=null?s.toString():"AsyncRequest error");l(t)}).setTimeoutHandler(h,function(){l("Timeout")});q.send()})})};f.exports=i}),null);
__d("FBRTCTransactions",["Promise","Map","RTCMessageSender"],(function a(b,c,d,e,f,g){"use strict";var h=6e4,i={INIT:0,PROCESSING:1,COMPLETED:2,TERMINATED:3};function j(){this.$FBRTCTransactionOwner1=new(c("Map"))()}j.prototype.findTransaction=function(l){return this.$FBRTCTransactionOwner1.get(l)};j.prototype.addTransaction=function(l){this.$FBRTCTransactionOwner1.set(l.id,l)};j.prototype.removeTransaction=function(l){this.$FBRTCTransactionOwner1["delete"](l.id)};j.prototype.getTransaction=function(l){return this.findTransaction(l.transactionId())||new k(this,l)};function k(l,m){this.id=m.transactionId();this.$FBRTCServerTransaction1=i.INIT;this.$FBRTCServerTransaction2=m;this.$FBRTCServerTransaction3=null;this.$FBRTCServerTransaction4=l;this.$FBRTCServerTransaction5=new Error("Unknown");this.$FBRTCServerTransaction6=null;this.$FBRTCServerTransaction7=new(c("RTCMessageSender"))();this.$FBRTCServerTransaction8();this.$FBRTCServerTransaction4.addTransaction(this)}k.prototype.start=function(){if(this.$FBRTCServerTransaction1==i.INIT){this.$FBRTCServerTransaction9(i.PROCESSING);return c("Promise").resolve(this.$FBRTCServerTransaction2)}else if(this.$FBRTCServerTransaction1==i.PROCESSING)return c("Promise").resolve(null);else if(this.$FBRTCServerTransaction1==i.COMPLETED){this.$FBRTCServerTransaction10();return c("Promise").resolve(null)}return c("Promise").reject(this.$FBRTCServerTransaction5)};k.prototype.sendResponse=function(l){this.$FBRTCServerTransaction3=l;this.$FBRTCServerTransaction9(i.COMPLETED);return this.$FBRTCServerTransaction7.send(l.message()).then(function(m){},function(m){this.$FBRTCServerTransaction5=m;this.$FBRTCServerTransaction9(i.TERMINATED)}.bind(this))};k.prototype.$FBRTCServerTransaction10=function(){if(this.$FBRTCServerTransaction3!=null){var l=this.$FBRTCServerTransaction3;l.incrementRetryCount();this.sendResponse(l)}};k.prototype.$FBRTCServerTransaction9=function(l){if(l!=this.$FBRTCServerTransaction1){this.$FBRTCServerTransaction1=l;if(this.$FBRTCServerTransaction1!=i.TERMINATED)this.$FBRTCServerTransaction8();if(this.$FBRTCServerTransaction1==i.TERMINATED){this.$FBRTCServerTransaction5=new Error("Terminated");this.$FBRTCServerTransaction4.removeTransaction(this)}}};k.prototype.$FBRTCServerTransaction8=function(){if(this.$FBRTCServerTransaction6){clearTimeout(this.$FBRTCServerTransaction6);this.$FBRTCServerTransaction6=null}this.$FBRTCServerTransaction6=setTimeout(function(){this.$FBRTCServerTransaction9(i.TERMINATED)}.bind(this),h)};f.exports={FBRTCTransactionOwner:j,FBRTCServerTransaction:k}}),null);
__d("RTCGroupCallDialogController",["DOM","FBRTCGroupCallVideoEscalationDialog.react","React","ReactDOM","RTCGroupCallAddMembersDialog.react"],(function a(b,c,d,e,f,g){"use strict";var h={_container:c("DOM").create("div"),showAddGroupMembersDialog:function i(j,k,l,m){c("ReactDOM").render(c("React").createElement(c("RTCGroupCallAddMembersDialog.react"),{participants:j,participantStates:k,thread:l,viewerID:m,onUnmount:function(){return this._onUnmount()}.bind(this)}),this._container)},showVideoEscalationDialog:function i(j,k){c("ReactDOM").render(c("React").createElement(c("FBRTCGroupCallVideoEscalationDialog.react"),{userName:j,onToggle:function(){this._onUnmount();k()}.bind(this)}),this._container)},_onUnmount:function i(){c("ReactDOM").unmountComponentAtNode(this._container)}};f.exports=h}),null);
__d("RTCCallActionTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({INCOMING_CALL_SUCCESS:"INCOMING_CALL_SUCCESS",RESET:"RESET",REMOTE_VIDEO_MUTED:"REMOTE_VIDEO_MUTED",REMOTE_VIDEO_UNMUTED:"REMOTE_VIDEO_UNMUTED"})}),null);
__d("RTCConferenceState",[],(function a(b,c,d,e,f,g){"use strict";var h={NEW:"NEW",AWAITING_USER_START:"AWAITING_USER_START",CONNECTING:"CONNECTING",CONNECTED:"CONNECTED",TERMINATING:"TERMINATING",TERMINATED:"TERMINATED"};f.exports=h}),null);
__d("FBRTCCallSummaryReducer",["FBRTCCallSummaryStore","FBRTCParticipantCallState","FBRTCLogger","RTCCallActionTypes","RTCCallStore","RTCConferenceState","RTCGroupCallActionTypes","RTCUtils"],(function a(b,c,d,e,f,g){"use strict";var h=c("FBRTCLogger").Key,i={setCallSummary:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").SET_CALL_SUMMARY:return k.set("callSummary",l.callSummary)}return k},setMWCallType:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").SET_MW_CALL_TYPE:k.callSummary.setCallType(l.callType);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k}return k},onCallStarted:function j(k,l){switch(l.type){case c("RTCCallActionTypes").INCOMING_CALL_SUCCESS:case c("RTCGroupCallActionTypes").CALL_SUCCESS:var m=function m(){var n=c("RTCCallStore").getState().callInfo.conferenceState;if(n!==c("RTCConferenceState").TERMINATED){k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());setTimeout(m,1e4)}};m();return k}return k},onMessageSignaling:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").ON_JOIN_REQUEST_SENT:if(k.callSummary.isCaller())k.callSummary.setOfferSentTime();else k.callSummary.setAnswerSentTime();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").ON_JOIN_RESPONSE:if(!k.callSummary.isCaller()){k.callSummary.onCallConnected();k.callSummary.onNetworkReady();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance())}k.callSummary.setServerInfoData(l.serverInfoData);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").ON_SERVER_MEDIA_UPDATE_SUCCESS:if(k.callSummary.isCaller()){k.callSummary.setAnswerReceivedTime();if(k.callSummary.isNetworkReady())k.callSummary.onCallConnected();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance())}return k;case c("RTCGroupCallActionTypes").ON_CONFERENCE_STATE:var m=c("RTCCallStore").getState().callInfo.conferenceName;if(c("RTCUtils").isGroupCall(m)){k.callSummary.onNetworkReady();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance())}var n=l.request.conferenceStateRequest(),o=n.participantStates;Object.keys(o).forEach(function(p){if(p!==c("RTCCallStore").getState().localUser.FBID)switch(o[p].state){case c("FBRTCParticipantCallState").UNKNOWN:case c("FBRTCParticipantCallState").CONTACTING:case c("FBRTCParticipantCallState").UNREACHABLE:return;case c("FBRTCParticipantCallState").CONNECTED:k.callSummary.onNetworkReady();if(k.callSummary.isAnswerReceived())k.callSummary.onCallConnected();default:if(k.callSummary.isCaller())k.callSummary.setOfferAckReceivedTime();k.callSummary.save(c("FBRTCCallSummaryStore").getInstance())}});return k}return k},onCallEnded:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").CALL_ERROR:case c("RTCGroupCallActionTypes").HANGUP:case c("RTCGroupCallActionTypes").END_CALL:k.callSummary.onCallEnded(l.endCallReason,false,false,l.endCallSubreason);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").DISMISS:k.callSummary.onCallEnded(l.endCallReason,true,false,l.endCallSubreason);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k}return k},onSurveyResult:function j(k,l){switch(l.type){case c("RTCGroupCallActionTypes").RATING_SHOWN:k.callSummary.addExtraInfo(h.RATING_SHOWN,"1");k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").FEEDBACK_SHOWN:k.callSummary.addExtraInfo(h.SURVEY_SHOWN,"1");k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").SUBMIT_RATING:k.callSummary.addExtraInfo(h.RATING,l.rating);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k;case c("RTCGroupCallActionTypes").SUBMIT_FEEDBACK:k.callSummary.addExtraInfo(h.SURVEY_DETAILS,l.feedback);k.callSummary.save(c("FBRTCCallSummaryStore").getInstance());return k}return k}};f.exports=i}),null);
__d("RTCCallControlReducer",["RTCGroupCallActionTypes"],(function a(b,c,d,e,f,g){"use strict";function h(i,j){switch(j.type){case c("RTCGroupCallActionTypes").AUDIO_MUTED:case c("RTCGroupCallActionTypes").AUDIO_UNMUTED:return i.set("localUser",i.localUser.toggleMuteAudio());case c("RTCGroupCallActionTypes").VIDEO_MUTED:case c("RTCGroupCallActionTypes").VIDEO_UNMUTED:return i.set("localUser",i.localUser.toggleMuteVideo())}return i}f.exports={toggleLocalStream:h}}),null);
__d("RTCCallReducer",["invariant","FBRTCParticipantCallState","FBRTCRtcResponseStatusCode","immutable","RTCCallActionTypes","RTCConferenceState","RTCGroupCallActionTypes","RTCUser","RTCUtils","URI"],(function a(b,c,d,e,f,g,h){"use strict";function i(y,z){switch(z.type){case c("RTCGroupCallActionTypes").INIT:return y.set("callInfo",y.callInfo.set("conferenceName",z.conferenceName).set("serverInfoData",z.serverInfoData).set("protocol",z.protocol));case c("RTCCallActionTypes").RESET:return y.set("callInfo",y.callInfo.set("conferenceState",c("RTCConferenceState").NEW).set("conferenceName",z.conferenceName)).set("callSummary",null).set("connections",c("immutable").Set()).set("remoteUsers",y.remoteUsers.map(function(A){return A.removeAllStreams()}))}return y}function j(y,z){switch(z.type){case c("RTCGroupCallActionTypes").CALL:return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").CONNECTING).set("connections",y.connections.add(z.peerConnection));case c("RTCGroupCallActionTypes").CALL_ERROR:return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").TERMINATED);case c("RTCGroupCallActionTypes").CALL_SUCCESS:if(z.connected)return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").CONNECTED);return y}return y}function k(y,z){switch(z.type){case c("RTCCallActionTypes").INCOMING_CALL_SUCCESS:return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").CONNECTED)}return y}function l(y,z){switch(z.type){case c("RTCGroupCallActionTypes").HANGUP:y.connections.forEach(function(A){return A.close()});return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").TERMINATING).set("connections",c("immutable").Set()).set("remoteUsers",y.remoteUsers.map(function(A){return A.removeAllStreams()}));case c("RTCGroupCallActionTypes").DISMISS:z.transaction.sendResponse(z.request.createResponse(c("FBRTCRtcResponseStatusCode").OK,{}));case c("RTCGroupCallActionTypes").END_CALL:y.connections.forEach(function(A){return A.close()});return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").TERMINATED).set("connections",c("immutable").Set()).set("remoteUsers",y.remoteUsers.map(function(A){return A.removeAllStreams()}));case c("RTCGroupCallActionTypes").HANGUP_ERROR:case c("RTCGroupCallActionTypes").HANGUP_SUCCESS:return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").TERMINATED)}return y}function m(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ON_PARTICIPANTS_ADDED:var A=y.remoteUsers.map(function(B){return B.FBID});return y.set("remoteUsers",y.remoteUsers.union(Object.keys(z.participants).filter(function(B){return!A.has(z.participants[B].fbid)}).map(function(B){var C=z.participants[B],D=C.big_image_src||C.image_src;if(z.images&&z.images[B])D=z.images[B];C.fbid||h(0);return new(c("RTCUser"))({FBID:C.fbid,profileUrl:new(c("URI"))(C.href),profilePictureUrl:D,isMessengerUser:!!C.is_messenger_user,isPartiesUser:!!C.is_parties_user,userName:C.name,userShortName:C.short_name,vanity:C.vanity})})))}return y}function n(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ON_CONFERENCE_STATE:var A=z.transaction,B=z.request,C=z.request.conferenceStateRequest();if(z.conferenceStateVersion>=C.version){A.sendResponse(B.createResponse(c("FBRTCRtcResponseStatusCode").OK,{ConferenceStateResponse:{currentVerison:z.conferenceStateVersion}}));return y}z.resolve(C.version);var D=y.remoteUsers.map(function(G){var H=C.participantStates[G.FBID];return H?G.setParticipantState(H):G}),E=D.some(function(G){var H=G.participantState;return H&&H.state===c("FBRTCParticipantCallState").CONNECTED}),F=E?c("RTCConferenceState").CONNECTED:y.callInfo.conferenceState;A.sendResponse(B.createResponse(c("FBRTCRtcResponseStatusCode").OK,{ConferenceStateResponse:{currentVerison:z.conferenceStateVersion}}));return y.setIn(["remoteUsers"],D).setIn(["callInfo","conferenceState"],F)}return y}function o(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ON_JOIN_RESPONSE:return y.setIn(["callInfo","serverInfoData"],z.serverInfoData)}return y}function p(y,z){switch(z.type){case c("RTCGroupCallActionTypes").INIT_LOCAL_USER:return y.set("localUser",z.localUser);case c("RTCGroupCallActionTypes").INIT_REMOTE_USERS:return y.set("remoteUsers",z.remoteUsers)}return y}function q(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ADD_LOCAL_STREAM:return y.set("localUser",y.localUser.addStream(z.stream));case c("RTCGroupCallActionTypes").REMOVE_LOCAL_STREAM:return y.set("localUser",y.localUser.removeStream(z.stream));case c("RTCGroupCallActionTypes").REPLACE_LOCAL_STREAM:return y.set("localUser",y.localUser.replaceStream(z.oldStream,z.newStream));case c("RTCGroupCallActionTypes").REMOVE_ALL_LOCAL_STREAMS:if(z.stopStreams)for(var A=y.localUser.streams,B=Array.isArray(A),C=0,A=B?A:A[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var D;if(B){if(C>=A.length)break;D=A[C++]}else{C=A.next();if(C.done)break;D=C.value}var E=D;c("RTCUtils").stopMediaStream(E)}return y.set("localUser",y.localUser.removeAllStreams())}return y}function r(y,z){switch(z.type){case c("RTCGroupCallActionTypes").ADD_LOCAL_SCREEN_STREAM:return y.set("localUser",y.localUser.addScreenStream(z.stream));case c("RTCGroupCallActionTypes").REMOVE_LOCAL_SCREEN_STREAM:return y.set("localUser",y.localUser.removeScreenStream(z.stream));case c("RTCGroupCallActionTypes").REMOVE_ALL_LOCAL_SCREEN_STREAMS:if(z.stopStreams)for(var A=y.localUser.screenStreams,B=Array.isArray(A),C=0,A=B?A:A[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var D;if(B){if(C>=A.length)break;D=A[C++]}else{C=A.next();if(C.done)break;D=C.value}var E=D;c("RTCUtils").stopMediaStream(E)}return y.set("localUser",y.localUser.removeAllScreenStreams())}return y}function s(y,z){var A=void 0;switch(z.type){case c("RTCGroupCallActionTypes").ADD_REMOTE_STREAM:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.addStream(z.stream)));case c("RTCGroupCallActionTypes").REMOVE_REMOTE_STREAM:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.removeStream(z.stream)));case c("RTCGroupCallActionTypes").REMOVE_ALL_REMOTE_STREAMS:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.removeAllStreams().removeAllScreenStreams()))}return y}function t(y,z){var A=void 0;switch(z.type){case c("RTCGroupCallActionTypes").ADD_REMOTE_TRACK:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.clone()));case c("RTCGroupCallActionTypes").REMOVE_REMOTE_TRACK:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.clone()))}return y}function u(y,z){var A=void 0;switch(z.type){case c("RTCGroupCallActionTypes").ADD_REMOTE_SCREEN_STREAM:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.addScreenStream(z.stream)));case c("RTCGroupCallActionTypes").REMOVE_REMOTE_SCREEN_STREAM:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.removeScreenStream(z.stream)))}return y}function v(y,z){var A=void 0;switch(z.type){case c("RTCGroupCallActionTypes").TOGGLE_REMOTE_STREAM:return y.set("remoteUsers",Object.entries(z.mediaStatus).reduce(function(B,C){var D=C[0],E=C[1],F=B.reduce(function(H,A){var G=A.streams.map(function(I){return I.getTracks().find(function(G){return G.id===D})}).find(Boolean);return G?{user:A,track:G}:H},{}),A=F.user,G=F.track;if(A&&G){if(G.kind==="audio"&&A.isAudioMuted()===E)return B["delete"](A).add(A.toggleMuteAudio());if(G.kind==="video"&&A.isVideoMuted()===E)return B["delete"](A).add(A.toggleMuteVideo())}return B},y.remoteUsers));case c("RTCCallActionTypes").REMOTE_VIDEO_MUTED:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.toggleMuteVideo(true)));case c("RTCCallActionTypes").REMOTE_VIDEO_UNMUTED:A=w(y,z);if(!A)return y;return y.setIn(["remoteUsers"],y.remoteUsers["delete"](A).add(A.toggleMuteVideo(false)))}return y}function w(y,z){return y.remoteUsers.find(function(A){if(z.userID)return A.FBID==z.userID;return A.FBID===z.stream.id.split(":")[0]})}function x(y,z){switch(z.type){case c("RTCGroupCallActionTypes").WAIT_FOR_USER_INPUT:if(y.callInfo.conferenceState===c("RTCConferenceState").NEW)return y.setIn(["callInfo","conferenceState"],c("RTCConferenceState").AWAITING_USER_START);return y}return y}f.exports={callInit:i,callStart:j,callEnd:l,onParticipantsChanged:m,incomingCallStart:k,initUsers:p,processLocalStream:q,processLocalScreenStream:r,processRemoteStream:s,processRemoteScreenStream:u,processRemoteTrack:t,toggleRemoteStream:v,processConferenceState:n,processJoinResponse:o,waitForUserInput:x}}),null);
__d("RTCCallStoreState",["CurrentUser","immutable","RTCConferenceState","RTCUser"],(function a(b,c,d,e,f,g){"use strict";var h,i,j,k,l={debugID:0,conferenceState:c("RTCConferenceState").NEW,conferenceName:"",protocol:"",serverInfoData:""};h=babelHelpers.inherits(m,c("immutable").Record(l));i=h&&h.prototype;function m(){h.apply(this,arguments)}var n={connections:c("immutable").Set(),localUser:new(c("RTCUser"))({FBID:c("CurrentUser").getID()}),remoteUsers:c("immutable").Set(),callInfo:new m(),callSummary:null};j=babelHelpers.inherits(o,c("immutable").Record(n));k=j&&j.prototype;function o(){j.apply(this,arguments)}f.exports=o}),null);
__d("RTCGroupCallDispatcher",["ExplicitRegistrationDispatcher"],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c("ExplicitRegistrationDispatcher"));i=h&&h.prototype;function j(k){"use strict";i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this)}f.exports=new j({strict:true})}),null);
__d("RTCCallStore",["FBRTCCallSummaryReducer","FluxReduceStore","RTCCallControlReducer","RTCCallReducer","MessengerRTCFunnelLogger","RTCCallStoreState","RTCGroupCallDispatcher"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=[c("FBRTCCallSummaryReducer").onCallEnded,c("FBRTCCallSummaryReducer").onCallStarted,c("FBRTCCallSummaryReducer").onMessageSignaling,c("FBRTCCallSummaryReducer").onSurveyResult,c("FBRTCCallSummaryReducer").setCallSummary,c("FBRTCCallSummaryReducer").setMWCallType,c("RTCCallControlReducer").toggleLocalStream,c("RTCCallReducer").callEnd,c("RTCCallReducer").callInit,c("RTCCallReducer").callStart,c("RTCCallReducer").incomingCallStart,c("RTCCallReducer").initUsers,c("RTCCallReducer").onParticipantsChanged,c("RTCCallReducer").processConferenceState,c("RTCCallReducer").processJoinResponse,c("RTCCallReducer").processLocalScreenStream,c("RTCCallReducer").processLocalStream,c("RTCCallReducer").processRemoteScreenStream,c("RTCCallReducer").processRemoteStream,c("RTCCallReducer").processRemoteTrack,c("RTCCallReducer").toggleRemoteStream,c("RTCCallReducer").waitForUserInput,c("MessengerRTCFunnelLogger").logRTCCallAction];h=babelHelpers.inherits(k,c("FluxReduceStore"));i=h&&h.prototype;k.prototype.getInitialState=function(){return new(c("RTCCallStoreState"))()};k.prototype.reduce=function(l,m){return j.reduce(function(l,n){return n(l,m)},l)};function k(){h.apply(this,arguments)}f.exports=new k(c("RTCGroupCallDispatcher"))}),null);
__d("RTCGroupCallActions",["RTCGroupCallActionTypes","RTCGroupCallDispatcher","RTCUtils"],(function a(b,c,d,e,f,g){"use strict";var h={setMWCallType:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_MW_CALL_TYPE,callType:j})},setLayout:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_LAYOUT,layout:j})},setDominantSpeaker:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_DOMINANT_SPEAKER,dominantSpeakerFBID:j})},setPinnedSpeaker:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_PINNED_SPEAKER,pinnedSpeakerFBID:j})},setUseDominantSpeakeView:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_USE_DOMINANT_SPEAKE_VIEW,useDominantSpeakeView:j})},setUseGridView:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_GRID_VIEW,useGridView:j})},setUseStripView:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_STRIP_VIEW,useStripView:j})},initThread:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").INIT_THREAD,thread:j,participants:k})},onParticipantLeft:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_PARTICIPANT_LEFT,participantFBID:j})},onParticipantsAdded:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_PARTICIPANTS_ADDED,participants:j,images:k})},addParticipantsToRing:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ADD_PARTICIPANTS_TO_RING,participantFBIDs:j})},toggleRemoteStream:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").TOGGLE_REMOTE_STREAM,mediaStatus:j})},handleDismissRequest:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").DISMISS,transaction:j,request:k,endCallReason:c("RTCUtils").endCallReasonFromDismissRequest(k.dismissRequest())})},handleConferenceStateRequest:function i(j,k,l,m){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_CONFERENCE_STATE,transaction:j,request:k,conferenceStateVersion:l,resolve:m})},onJoinRequestSent:function i(){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_JOIN_REQUEST_SENT})},onJoinResponse:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_JOIN_RESPONSE,serverInfoData:j})},onServerMediaUpdateSuccess:function i(){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_SERVER_MEDIA_UPDATE_SUCCESS})},onClientMediaUpdateResponse:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ON_CLIENT_MEDIA_UPDATE_RESPONSE,responseStatusCode:j,currentVersion:k})}};f.exports=h}),null);
__d("RTCMWSessionDescription",["Promise","FBRTCMediaType","RTCCallStore","RTCConfig","RTCGroupCallActions","RTCGroupCallDialogController"],(function a(b,c,d,e,f,g){"use strict";var h={_videoEnabled:{},serverMediaUpdate:function i(j,k){var l,m=j.fromVersion,n=j.toVersion,o=j.mediaUpdates,p=c("RTCCallStore").getState().connections.first(),q=p.getLocalDescription(),r=p.getRemoteDescription(),s=r.sessionDescription.getVersion();if(s!==m){k(s);return}var t=function(){o.forEach(function(u){r.processServerMediaUpdate(u);u.media.forEach(function(v){var w=v.type,x=v.enabled;if(w===c("FBRTCMediaType").VIDEO)this._videoEnabled[u.sourceKey]=x}.bind(this))}.bind(this));r.sessionDescription.setVersion(n);c("Promise").all([p.setLocalDescription(q),p.setRemoteDescription(r)]).then(function(){var v;c("RTCGroupCallActions").toggleRemoteStream((v=[]).concat.apply(v,o.map(function(w){var x=w.media;return x})).reduce(function(w,x){var y=x.id,z=x.enabled;w[y]=z;return w},{}));k(n)},function(){return k(s)})["catch"](function(v){})}.bind(this),u=o.find(function(v){var w=v.sourceKey,x=v.media;return!this._videoEnabled[w]&&x.some(function(y){var z=y.type,A=y.enabled;return z===c("FBRTCMediaType").VIDEO&&A})}.bind(this));if(c("RTCConfig").RtcConferencingVideoGK&&!c("RTCCallStore").getState().localUser.hasVideo()&&u)(function(){var v=u.sourceKey.split(":"),w=v[0],x=c("RTCCallStore").getState().remoteUsers.find(function(x){return x.FBID===w});c("RTCGroupCallDialogController").showVideoEscalationDialog(x.userName,t)})();else t()}};f.exports=h}),null);
__d("MultiwayParticipantFetcher",["Promise","regeneratorRuntime","BonfireUserFetcher","ImmutableObject","MercuryIDs","MercuryParticipants","immutable","RTCUtils"],(function a(b,c,d,e,f,g){"use strict";var h=c("immutable").Set,i=c("immutable").Map;function j(o){var p=c("MercuryIDs").getParticipantIDFromUserID(o);return new(c("Promise"))(function(q,r){try{c("MercuryParticipants").get(p,function(t){q(t)})}catch(s){r(s)}})}function k(o,p){var q=o.map(function(r){return c("MercuryIDs").getParticipantIDFromUserID(r)});return new(c("Promise"))(function(r,s){try{c("MercuryParticipants").getBigImageMulti(q.toArray(),function(u){r(c("immutable").fromJS(u))},p)}catch(t){s(t)}})}function l(o){var p=o.map(function(q){return c("MercuryIDs").getParticipantIDFromUserID(q)});return new(c("Promise"))(function(q,r){try{c("MercuryParticipants").getMulti(p.toArray(),function(t){q(c("immutable").fromJS(t))})}catch(s){r(s)}})}function m(o,p){var q,r=this,s,q;return c("regeneratorRuntime").async(function t(u){while(1)switch(u.prev=u.next){case 0:u.next=2;return c("regeneratorRuntime").awrap(l(o));case 2:s=u.sent;if(!p.profileImageSize){u.next=9;break}u.next=6;return c("regeneratorRuntime").awrap(function v(){var w;return c("regeneratorRuntime").async(function x(y){while(1)switch(y.prev=y.next){case 0:y.next=2;return c("regeneratorRuntime").awrap(k(o,p.profileImageSize));case 2:w=y.sent;return y.abrupt("return",{v:s.withMutations(function(z){w.forEach(function(A,B){var C=z.get(B);if(C){var D=c("ImmutableObject").setProperty(C,"big_image_src",A);z.set(B,D)}})})});case 4:case"end":return y.stop()}},null,r)}());case 6:q=u.sent;if(!(typeof q==="object")){u.next=9;break}return u.abrupt("return",q.v);case 9:return u.abrupt("return",s);case 10:case"end":return u.stop()}},null,this)}var n={fetchParticipant:function o(p,q){return c("regeneratorRuntime").async(function r(s){while(1)switch(s.prev=s.next){case 0:if(!c("RTCUtils").isPartiesCall(p)){s.next=6;break}s.next=3;return c("regeneratorRuntime").awrap(c("BonfireUserFetcher").fetchParticipant(q));case 3:return s.abrupt("return",s.sent);case 6:s.next=8;return c("regeneratorRuntime").awrap(j(q));case 8:return s.abrupt("return",s.sent);case 9:case"end":return s.stop()}},null,this)},fetchAllParticipants:function o(p,q){var r=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];return c("regeneratorRuntime").async(function s(t){while(1)switch(t.prev=t.next){case 0:if(!c("RTCUtils").isPartiesCall(p)){t.next=6;break}t.next=3;return c("regeneratorRuntime").awrap(c("BonfireUserFetcher").fetchAllParticipants(q));case 3:return t.abrupt("return",t.sent);case 6:t.next=8;return c("regeneratorRuntime").awrap(m(q,r));case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}},null,this)}};f.exports=n}),null);
__d("RTCCallActions",["RTCCallActionTypes","RTCGroupCallActionTypes","RTCGroupCallDispatcher","RTCUtils","emptyFunction","mixInEventEmitter"],(function a(b,c,d,e,f,g){"use strict";var h={addListener:c("emptyFunction"),emit:c("emptyFunction"),initialize:function i(j,k,l,m,n){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").INIT,conferenceName:k,callID:m,serverInfoData:l,protocol:j,callTrigger:n})},reset:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCCallActionTypes").RESET,conferenceName:j})},setCallSummary:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SET_CALL_SUMMARY,callSummary:j})},call:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").CALL,usersToRing:j,peerConnection:k})},callSuccess:function i(){var j=arguments.length<=0||arguments[0]===undefined?false:arguments[0];c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").CALL_SUCCESS,connected:j})},incomingCallSuccess:function i(){c("RTCGroupCallDispatcher").dispatch({type:c("RTCCallActionTypes").INCOMING_CALL_SUCCESS})},callError:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").CALL_ERROR,endCallReason:c("RTCUtils").endCallReasonFromResponseStatusCode(j),endCallSubreason:"Call error: "+(j||0)})},hangupSuccess:function i(){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").HANGUP_SUCCESS})},hangupError:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").HANGUP_ERROR,error:j})},join:function i(j){h.call([],j)},hangup:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").HANGUP,hangupReason:j,detailedReasonString:k,endCallReason:c("RTCUtils").endCallReasonFromHangupReason(j)})},initLocalUser:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").INIT_LOCAL_USER,localUser:j})},initRemoteUsers:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").INIT_REMOTE_USERS,remoteUsers:j})},addLocalStream:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ADD_LOCAL_STREAM,stream:j})},removeLocalStream:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").REMOVE_LOCAL_STREAM,stream:j})},replaceLocalStream:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").REPLACE_LOCAL_STREAM,oldStream:j,newStream:k})},removeAllLocalStreams:function i(){var j=arguments.length<=0||arguments[0]===undefined?false:arguments[0];c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").REMOVE_ALL_LOCAL_STREAMS,stopStreams:j})},removeAllLocalScreenStreams:function i(){var j=arguments.length<=0||arguments[0]===undefined?false:arguments[0];c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").REMOVE_ALL_LOCAL_SCREEN_STREAMS,stopStreams:j})},addRemoteStream:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ADD_REMOTE_STREAM,stream:j,userID:k})},removeRemoteStream:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").REMOVE_REMOTE_STREAM,stream:j,userID:k})},removeAllRemoteStreams:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").REMOVE_ALL_REMOTE_STREAMS,userID:j})},addRemoteTrack:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ADD_REMOTE_TRACK,stream:j,track:k})},removeRemoteTrack:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").REMOVE_REMOTE_TRACK,stream:j,track:k})},addLocalScreenStream:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ADD_LOCAL_SCREEN_STREAM,stream:j})},removeLocalScreenStream:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").REMOVE_LOCAL_SCREEN_STREAM,stream:j})},addRemoteScreenStream:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").ADD_REMOTE_SCREEN_STREAM,stream:j,userID:k})},removeRemoteScreenStream:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").REMOVE_REMOTE_SCREEN_STREAM,stream:j,userID:k})},endCall:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").END_CALL,endCallReason:j,endCallSubreason:k})},waitForUserInput:function i(){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").WAIT_FOR_USER_INPUT})},toggleMuteAudio:function i(j){c("RTCGroupCallDispatcher").dispatch({type:j?c("RTCGroupCallActionTypes").AUDIO_UNMUTED:c("RTCGroupCallActionTypes").AUDIO_MUTED})},toggleMuteVideo:function i(j){c("RTCGroupCallDispatcher").dispatch({type:j?c("RTCGroupCallActionTypes").VIDEO_UNMUTED:c("RTCGroupCallActionTypes").VIDEO_MUTED})},toggleMuteRemoteVideo:function i(j,k){c("RTCGroupCallDispatcher").dispatch({type:j?c("RTCCallActionTypes").REMOTE_VIDEO_MUTED:c("RTCCallActionTypes").REMOTE_VIDEO_UNMUTED,userID:k})},toggleSelfView:function i(j){c("RTCGroupCallDispatcher").dispatch({type:j?c("RTCGroupCallActionTypes").SELF_VIEW_COLLAPSED:c("RTCGroupCallActionTypes").SELF_VIEW_UNCOLLAPSED})},submitRating:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SUBMIT_RATING,rating:j})},submitFeedback:function i(j){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").SUBMIT_FEEDBACK,feedback:j})},ratingShown:function i(){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").RATING_SHOWN})},feedbackShown:function i(){c("RTCGroupCallDispatcher").dispatch({type:c("RTCGroupCallActionTypes").FEEDBACK_SHOWN})}};c("mixInEventEmitter")(h,{onIceConnectionStateChange:true});f.exports=h}),null);
__d("RTCMultiwayMessageHandler",["Arbiter","ChannelConstants","CurrentUser","FBRTCCallSummary","FBRTCCapability","FBRTCDeviceStatus","FBRTCHangupReason","FBRTCMultiwayMessage","FBRTCRtcResponseStatusCode","FBRTCTransactions","immutable","MultiwayParticipantFetcher","RTCCallActions","RTCCallStore","RTCGroupCallActions","RTCMWProtocolHandler","RTCMWSessionDescription","RTCUtils"],(function a(b,c,d,e,f,g){"use strict";var h=c("FBRTCTransactions").FBRTCServerTransaction,i=c("FBRTCTransactions").FBRTCTransactionOwner;function j(){this.$RTCMultiwayMessageHandler3=-1;this.$RTCMultiwayMessageHandler5()}j.prototype.initialize=function(k,l){this.$RTCMultiwayMessageHandler1=k;this.$RTCMultiwayMessageHandler2=l};j.initHandler=function(k,l){new j().initialize(k,l)};j.close=function(){if(j.$RTCMultiwayMessageHandler4){c("Arbiter").unsubscribe(j.$RTCMultiwayMessageHandler4);j.$RTCMultiwayMessageHandler4=null}};j.prototype.$RTCMultiwayMessageHandler5=function(){j.$RTCMultiwayMessageHandler4=c("Arbiter").subscribe([c("ChannelConstants").getArbiterType("rtc_live_json"),c("ChannelConstants").getArbiterType("rtc_multi_json")],function(k,l){this.$RTCMultiwayMessageHandler6(l.obj)}.bind(this))};j.prototype.$RTCMultiwayMessageHandler6=function(k){var l,m=this,n=new(c("FBRTCMultiwayMessage"))(k);if(!n.isRequest())return;if(this.$RTCMultiwayMessageHandler1===n.conferenceName())this.$RTCMultiwayMessageHandler7(n);else if(n.ringRequest())(function(){var o=new h(new i(),n);o.start().done(function(p){var q=c("RTCUtils").generateRandomInt(),r=new(c("FBRTCCallSummary"))({peerID:c("RTCUtils").isGroupCall(p.conferenceName())?-1:c("RTCUtils").getPeerID(p.conferenceName()),callID:q,isCaller:false});o.sendResponse(this.$RTCMultiwayMessageHandler8(p,q,r)).done(function(){return c("RTCMWProtocolHandler").otherUserInAnotherCall(n.conferenceName(),n.serverInfoData(),c("FBRTCHangupReason").IN_ANOTHER_CALL,"InAnotherCall")})}.bind(m))})()};j.prototype.$RTCMultiwayMessageHandler8=function(k,l,m){var n=k.ringRequest(),o=k.serverInfoData();if(n==null||o==null)return k.createResponse(c("FBRTCRtcResponseStatusCode").BAD_REQUEST);var p={deviceCapabilities:[c("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,c("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED],deviceStatus:c("FBRTCDeviceStatus").OK};return k.createResponse(c("FBRTCRtcResponseStatusCode").OK,{ringResponse:p})};j.prototype.$RTCMultiwayMessageHandler7=function(k){var l=new h(new i(),k);l.start().then(function(m){var n,o=this;if(m!=null)if(m.dismissRequest()!=null){var p=c("RTCCallStore").getState(),q=p.callInfo,r=p.connections;if(m.serverInfoData()===q.serverInfoData){c("RTCGroupCallActions").handleDismissRequest(l,m);j.close();r.forEach(function(s){return s.close()});c("RTCCallActions").removeAllLocalStreams(true)}}else if(m.serverMediaUpdateRequest()!=null)c("RTCMWSessionDescription").serverMediaUpdate(m.serverMediaUpdateRequest(),function(s){c("RTCGroupCallActions").onServerMediaUpdateSuccess();l.sendResponse(m.createResponse(c("FBRTCRtcResponseStatusCode").OK,{serverMediaUpdateResponse:{currentVersion:s}}))});else if(m.conferenceStateRequest()!=null)(function(){var s=c("RTCCallStore").getState(),t=s.remoteUsers,u=t.map(function(x){return x.FBID}),v=Object.keys(m.conferenceStateRequest().participantStates),w=v.filter(function(x){return x!==c("CurrentUser").getID()&&!u.has(x)});if(w.length>0)c("MultiwayParticipantFetcher").fetchAllParticipants(o.$RTCMultiwayMessageHandler1,c("immutable").Set(w),{profileImageSize:100}).done(function(x){c("RTCGroupCallActions").onParticipantsAdded(x.toJS());c("RTCGroupCallActions").handleConferenceStateRequest(l,m,this.$RTCMultiwayMessageHandler3,function(y){this.$RTCMultiwayMessageHandler3=y}.bind(this))}.bind(o));else c("RTCGroupCallActions").handleConferenceStateRequest(l,m,o.$RTCMultiwayMessageHandler3,function(x){this.$RTCMultiwayMessageHandler3=x}.bind(o))})()}.bind(this)).done()};f.exports=j}),null);
__d("FBRTCClientMediaUpdateReducer",["FBRTCRtcResponseStatusCode","RTCCallStore","RTCGroupCallActionTypes","RTCMWProtocolHandler"],(function a(b,c,d,e,f,g){"use strict";var h={configureAudio:function k(l,m){switch(m.type){case c("RTCGroupCallActionTypes").AUDIO_MUTED:return i(l,"audio",false);case c("RTCGroupCallActionTypes").AUDIO_UNMUTED:return i(l,"audio",true)}return l},configureVideo:function k(l,m){switch(m.type){case c("RTCGroupCallActionTypes").VIDEO_MUTED:return i(l,"video",false);case c("RTCGroupCallActionTypes").VIDEO_UNMUTED:return i(l,"video",true)}return l},onClientMediaUpdateResponse:function k(l,m){switch(m.type){case c("RTCGroupCallActionTypes").ON_CLIENT_MEDIA_UPDATE_RESPONSE:if(m.responseStatusCode!==c("FBRTCRtcResponseStatusCode").OK)return l;l=l.setIn(["clientMediaUpdateInfo","lastSyncedClientVersion"],m.currentVersion);if(l.clientMediaUpdateInfo.pendingResponse){l=l.setIn(["clientMediaUpdateInfo","pendingResponse"],false);if(l.clientMediaUpdateInfo.pendingUpdate)return j(l.setIn(["clientMediaUpdateInfo","pendingUpdate"],false))}return l}return l}};function i(k,l,m){var n=c("RTCCallStore").getState().connections.first().getLocalStreams()[0].getTracks().reduce(function(n,o){n[o.id]=o.kind===l?m:o.enabled;return n},{});return j(k.setIn(["clientMediaUpdateInfo","localMediaUpdates"],k.clientMediaUpdateInfo.localMediaUpdates.push({mediaStatus:n})))}function j(k){if(k.clientMediaUpdateInfo.pendingResponse)return k.setIn(["clientMediaUpdateInfo","pendingUpdate"],true);var l=k.clientMediaUpdateInfo.localMediaUpdates.reduce(function(m,n,o){if(o>=k.clientMediaUpdateInfo.lastSyncedClientVersion)m.push(n);return m},[]);if(l.length===0)return k;c("RTCMWProtocolHandler").clientMediaUpdate(c("RTCCallStore").getState().callInfo.conferenceName,c("RTCCallStore").getState().callInfo.serverInfoData,k.clientMediaUpdateInfo.lastSyncedClientVersion,k.clientMediaUpdateInfo.localMediaUpdates.size,l);return k.setIn(["clientMediaUpdateInfo","pendingResponse"],true)}f.exports=h}),null);
__d("FBRTCGroupCallParticipantsReducer",["MercuryIDs","RTCCallStore","RTCGroupCallActionTypes","RTCMWProtocolHandler","Set"],(function a(b,c,d,e,f,g){"use strict";var h={_participantsToRing:new(c("Set"))(),initThread:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").INIT_THREAD:return j.merge({participants:k.participants,thread:k.thread})}return j},onParticipantsChanged:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").ON_PARTICIPANT_LEFT:return j.set("participants",j.participants["delete"](c("MercuryIDs").getParticipantIDFromUserID(k.participantFBID)));case c("RTCGroupCallActionTypes").ON_PARTICIPANTS_ADDED:var l=Object.keys(k.participants).map(function(m){return k.participants[m].fbid}).filter(function(m){return h._participantsToRing.has(m)});if(l.length!==0){l.forEach(function(m){return h._participantsToRing["delete"](m)});c("RTCMWProtocolHandler").addParticipants(c("RTCCallStore").getState().callInfo.conferenceName,c("RTCCallStore").getState().callInfo.serverInfoData,l)}return j.set("participants",j.participants.merge(k.participants))}return j},addParticipantsToRing:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").ADD_PARTICIPANTS_TO_RING:k.participantFBIDs.forEach(function(l){return h._participantsToRing.add(l)});return j}return j}};f.exports=h}),null);
__d("FBRTCGroupCallReducer",["FBRTCParticipantCallState","RTCCallStore","RTCEndCallReason","RTCGroupCallActionTypes","RTCMWProtocolHandler"],(function a(b,c,d,e,f,g){"use strict";var h={setDominantSpeaker:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").SET_DOMINANT_SPEAKER:return j.set("dominantSpeakerFBID",k.dominantSpeakerFBID);case c("RTCGroupCallActionTypes").SET_PINNED_SPEAKER:var l=c("RTCCallStore").getState(),m=l.callInfo,n=l.connections;c("RTCMWProtocolHandler").subscription(m.conferenceName,m.serverInfoData,n.first().getRemoteStreams(),j.layout,k.pinnedSpeakerFBID);return j.set("pinnedSpeakerFBID",k.pinnedSpeakerFBID);case c("RTCGroupCallActionTypes").ON_CONFERENCE_STATE:var o=k.request.conferenceStateRequest(),p=o.participantStates,q=p[j.pinnedSpeakerFBID];if(q&&q.state!==c("FBRTCParticipantCallState").CONNECTED)return j.set("pinnedSpeakerFBID",null);return j}return j},setLayout:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").SET_LAYOUT:var l=c("RTCCallStore").getState(),m=l.callInfo,n=l.connections;if(n.size>0)c("RTCMWProtocolHandler").subscription(m.conferenceName,m.serverInfoData,n.first().getRemoteStreams(),k.layout,j.pinnedSpeakerFBID);return j.set("layout",k.layout)}return j},setGKSettings:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").SET_USE_DOMINANT_SPEAKE_VIEW:return j.set("useDominantSpeakeView",k.useDominantSpeakeView);case c("RTCGroupCallActionTypes").SET_GRID_VIEW:return j.set("useGridView",k.useGridView);case c("RTCGroupCallActionTypes").SET_STRIP_VIEW:return j.set("useStripView",k.useStripView)}return j},processEndCallReason:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").CALL_ERROR:case c("RTCGroupCallActionTypes").HANGUP:case c("RTCGroupCallActionTypes").END_CALL:case c("RTCGroupCallActionTypes").DISMISS:return j.set("endCallReason",j.endCallReason||new(c("RTCEndCallReason"))(k.endCallReason))}return j}};f.exports=h}),null);
__d("RTCStreamDurationTracker",["performanceNow"],(function a(b,c,d,e,f,g){"use strict";function h(){var i=arguments.length<=0||arguments[0]===undefined?"mixed":arguments[0];this.$RTCStreamDurationTracker3=0;this.$RTCStreamDurationTracker4=0;this.$RTCStreamDurationTracker5=false;this.update=function(){if(!this.$RTCStreamDurationTracker5)return;if(this.$RTCStreamDurationTracker6()){if(this.$RTCStreamDurationTracker4===0)this.$RTCStreamDurationTracker4=c("performanceNow")()}else{this.$RTCStreamDurationTracker3=this.getDuration();this.$RTCStreamDurationTracker4=0}}.bind(this);this.$RTCStreamDurationTracker1=i}h.prototype.isStarted=function(){return this.$RTCStreamDurationTracker5};h.prototype.track=function(i){if(i===this.$RTCStreamDurationTracker2){this.update();return}if(this.$RTCStreamDurationTracker2&&this.$RTCStreamDurationTracker5){var j=this.$RTCStreamDurationTracker2;j.removeEventListener("addtrack",this.update);j.removeEventListener("removetrack",this.update)}if(i){this.$RTCStreamDurationTracker2=i;if(this.$RTCStreamDurationTracker5)this.start()}else this.stop()};h.prototype.$RTCStreamDurationTracker6=function(){if(!this.$RTCStreamDurationTracker2)return false;return this.$RTCStreamDurationTracker7().some(function(i){return i.enabled})};h.prototype.$RTCStreamDurationTracker7=function(){if(!this.$RTCStreamDurationTracker2)return[];switch(this.$RTCStreamDurationTracker1){case"audio":return this.$RTCStreamDurationTracker2.getAudioTracks();case"video":return this.$RTCStreamDurationTracker2.getVideoTracks();default:return this.$RTCStreamDurationTracker2.getTracks()}};h.prototype.getDuration=function(){return this.$RTCStreamDurationTracker4===0?this.$RTCStreamDurationTracker3:this.$RTCStreamDurationTracker3+c("performanceNow")()-this.$RTCStreamDurationTracker4};h.prototype.start=function(){this.$RTCStreamDurationTracker5=true;if(this.$RTCStreamDurationTracker6())this.$RTCStreamDurationTracker4=c("performanceNow")();if(this.$RTCStreamDurationTracker2){var i=this.$RTCStreamDurationTracker2;i.addEventListener("addtrack",this.update);i.addEventListener("removetrack",this.update)}};h.prototype.stop=function(){if(!this.$RTCStreamDurationTracker5)return;this.$RTCStreamDurationTracker3=this.getDuration();this.$RTCStreamDurationTracker5=false;this.$RTCStreamDurationTracker4=0;if(this.$RTCStreamDurationTracker2){var i=this.$RTCStreamDurationTracker2;i.removeEventListener("addtrack",this.update);i.removeEventListener("removetrack",this.update)}};f.exports=h}),null);
__d("FBRTCGroupCallStoreState",["immutable","RTCStreamDurationTracker"],(function a(b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n={pendingResponse:false,pendingUpdate:false,lastSyncedClientVersion:2,localMediaUpdates:c("immutable").List([{mediaStatus:{}},{mediaStatus:{}}])};h=babelHelpers.inherits(o,c("immutable").Record(n));i=h&&h.prototype;function o(){h.apply(this,arguments)}var p={localVideoDurationTracker:new(c("RTCStreamDurationTracker"))("video"),remoteVideoDurationTracker:new(c("RTCStreamDurationTracker"))("video")};j=babelHelpers.inherits(q,c("immutable").Record(p));k=j&&j.prototype;function q(){j.apply(this,arguments)}var r={dominantSpeakerFBID:null,endCallReason:null,layout:null,participants:null,pinnedSpeakerFBID:null,thread:null,clientMediaUpdateInfo:new o(),useDominantSpeakeView:false,useGridView:false,useStripView:false,videoDurationTrackerInfo:new q()};l=babelHelpers.inherits(s,c("immutable").Record(r));m=l&&l.prototype;function s(){l.apply(this,arguments)}f.exports=s}),null);
__d("FBRTCVideoDurationTrackerReducer",["FBRTCCallSummaryStore","RTCCallStore","RTCGroupCallActionTypes"],(function a(b,c,d,e,f,g){"use strict";var h={track:function i(j,k){var l=j.videoDurationTrackerInfo,m=l.localVideoDurationTracker,n=l.remoteVideoDurationTracker;switch(k.type){case c("RTCGroupCallActionTypes").ADD_LOCAL_STREAM:m.start();m.track(k.stream);return j;case c("RTCGroupCallActionTypes").ADD_REMOTE_STREAM:case c("RTCGroupCallActionTypes").TOGGLE_REMOTE_STREAM:var o=c("RTCCallStore").getState(),p=o.remoteUsers,q=p.find(function(q){return!q.isVideoMuted()});n.stop();n.start();n.track(q&&q.streams.first());return j}return j},update:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").VIDEO_MUTED:case c("RTCGroupCallActionTypes").VIDEO_UNMUTED:j.videoDurationTrackerInfo.localVideoDurationTracker.update()}return j},stop:function i(j,k){switch(k.type){case c("RTCGroupCallActionTypes").DISMISS:case c("RTCGroupCallActionTypes").END_CALL:case c("RTCGroupCallActionTypes").HANGUP:var l=j.videoDurationTrackerInfo,m=c("RTCCallStore").getState(),n=m.callSummary;n.setVideoDurations(l.localVideoDurationTracker.getDuration(),l.remoteVideoDurationTracker.getDuration());n.save(c("FBRTCCallSummaryStore").getInstance());return j}return j}};f.exports=h}),null);
__d("FBRTCGroupCallStore",["FBRTCClientMediaUpdateReducer","FBRTCGroupCallParticipantsReducer","FBRTCGroupCallReducer","FBRTCGroupCallStoreState","FBRTCVideoDurationTrackerReducer","FluxReduceStore","RTCGroupCallDispatcher"],(function a(b,c,d,e,f,g){"use strict";var h,i,j=[c("FBRTCClientMediaUpdateReducer").configureAudio,c("FBRTCClientMediaUpdateReducer").configureVideo,c("FBRTCClientMediaUpdateReducer").onClientMediaUpdateResponse,c("FBRTCGroupCallParticipantsReducer").addParticipantsToRing,c("FBRTCGroupCallParticipantsReducer").initThread,c("FBRTCGroupCallParticipantsReducer").onParticipantsChanged,c("FBRTCGroupCallReducer").processEndCallReason,c("FBRTCGroupCallReducer").setDominantSpeaker,c("FBRTCGroupCallReducer").setGKSettings,c("FBRTCGroupCallReducer").setLayout,c("FBRTCVideoDurationTrackerReducer").track,c("FBRTCVideoDurationTrackerReducer").update,c("FBRTCVideoDurationTrackerReducer").stop];h=babelHelpers.inherits(k,c("FluxReduceStore"));i=h&&h.prototype;k.prototype.getInitialState=function(){return new(c("FBRTCGroupCallStoreState"))()};k.prototype.reduce=function(l,m){return j.reduce(function(l,n){return n(l,m)},l)};function k(){h.apply(this,arguments)}f.exports=new k(c("RTCGroupCallDispatcher"))}),null);
__d("FBRTCGroupCallVideoEscalationDialog.react",["fbt","FBRTCConstants","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogFooter.react","React","RTCGroupCallActions","RTCMWProtocolHandler"],(function a(b,c,d,e,f,g,h){"use strict";var i=c("FBRTCConstants").CallType,j=function j(k){var l=k.userName,m=k.onToggle;return c("React").createElement(c("MessengerDialog.react"),{onToggle:m},c("React").createElement(c("MessengerDialogBody.react"),null,h._("{name} added video chat. Would you like to share your video?",[h.param("name",l)])),c("React").createElement(c("MessengerDialogFooter.react"),null,c("React").createElement(c("MessengerDialogCancelButton.react"),{onClick:function n(){return c("RTCGroupCallActions").setMWCallType(i.ESCALATION_DECLINED)}}),c("React").createElement(c("MessengerDialogButton.react"),{label:h._("Share Video"),onClick:function n(){c("RTCMWProtocolHandler").videoEscalation();m()},type:"primary"})))};f.exports=j}),null);
__d("RTCGroupCallAddMembersDialog.react",["cx","fbt","FluxContainer","immutable","MercuryIDs","MercuryLogMessageType","MercuryMessageActions","MercuryMessageObject","MercuryTriodeSourceUtil","MessengerAdminGroupUtils","MessengerDialog.react","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogHeader.react","MessengerDialogTitle.react","MessengerGraphQLTokenizer.react","MessengerRTCGroupCallContactList.react","MessengerRTCGroupCallThreadRow.react","React","RTCCallStore","RTCConferenceState","RTCGroupCallActions","RTCGroupCallDispatcher","RTCMWProtocolHandler"],(function a(b,c,d,e,f,g,h,i){"use strict";var j,k,l=c("React").PureComponent,m=460;j=babelHelpers.inherits(n,l);k=j&&j.prototype;n.getStores=function(){return[c("RTCCallStore")]};n.calculateState=function(){return{remoteUsers:c("RTCCallStore").getState().remoteUsers}};function n(o){k.constructor.call(this,o);this.state={isParticipantSelected:this.props.participants.mapEntries(function(p){var q=p[0],r=p[1];return[q,false]}),newParticipants:c("immutable").List(),remoteUsers:c("immutable").Set()};this.$RTCGroupCallAddMembersDialog1=function(p){this.setState({isParticipantSelected:this.state.isParticipantSelected.set(p,!this.state.isParticipantSelected.get(p))})}.bind(this);this.$RTCGroupCallAddMembersDialog2=function(){var p=this.props,q=p.onUnmount,r=p.thread;q();var s=this.state.newParticipants.toArray().map(function(u){return u.getUniqueID()}),t=this.$RTCGroupCallAddMembersDialog3().map(function(u){var v=u.fbid;return v||""});if(r){c("RTCGroupCallActions").addParticipantsToRing(s);this.$RTCGroupCallAddMembersDialog7(r);if(t.length>0)c("RTCMWProtocolHandler").addParticipants(c("RTCCallStore").getState().callInfo.conferenceName,c("RTCCallStore").getState().callInfo.serverInfoData,t)}else c("RTCMWProtocolHandler").addParticipants(c("RTCCallStore").getState().callInfo.conferenceName,c("RTCCallStore").getState().callInfo.serverInfoData,[].concat(s,t))}.bind(this);this.$RTCGroupCallAddMembersDialog4=function(p){this.setState({newParticipants:this.state.newParticipants.push(p)})}.bind(this);this.$RTCGroupCallAddMembersDialog6=function(p){var q=p.getUniqueID(),r=this.state.newParticipants,s=r.findIndex(function(t){return t.getUniqueID()===q});if(s!==-1)this.setState({newParticipants:r["delete"](s)})}.bind(this);this.$RTCGroupCallAddMembersDialog5=function(){this.setState({newParticipants:c("immutable").List()})}.bind(this);c("RTCGroupCallDispatcher").explicitlyRegisterStores([c("RTCCallStore")])}n.prototype.render=function(){var o=this.props,p=o.participants,q=o.thread,r=o.viewerID,s=c("RTCCallStore").getState().callInfo.conferenceState;if(s!==c("RTCConferenceState").CONNECTED)return null;var t=c("React").createElement("div",{className:"_2t45"},c("React").createElement("div",{className:"_225b"},i._("Group Members")),c("React").createElement(c("MessengerRTCGroupCallContactList.react"),{isParticipantSelected:this.state.isParticipantSelected,onClick:this.$RTCGroupCallAddMembersDialog1,remoteUsers:this.state.remoteUsers.toArray().sort(function(u,v){return u.userName.localeCompare(v.userName)}),participantStates:c("immutable").Map(this.state.remoteUsers.map(function(u){return[u.FBID,u.participantState]}))}));return c("React").createElement(c("MessengerDialog.react"),{onToggle:this.props.onUnmount,type:"default",width:m},c("React").createElement("div",{className:"_5zad"},c("React").createElement(c("MessengerDialogHeader.react"),null,c("React").createElement(c("MessengerDialogCancelButton.react"),null),c("React").createElement(c("MessengerDialogTitle.react"),null,i._("Add Group Members")),c("React").createElement(c("MessengerDialogButton.react"),{label:i._("Ring"),onClick:this.$RTCGroupCallAddMembersDialog2,disabled:this.$RTCGroupCallAddMembersDialog3().length+this.state.newParticipants.size===0,type:"primary"})),c("React").createElement(c("MessengerRTCGroupCallThreadRow.react"),{displayAddMemberWarning:true,participants:p,thread:q,viewerID:r}),c("React").createElement(c("MessengerGraphQLTokenizer.react"),{autoFocus:false,context:null,className:"_2el3",defaultEntries:t,enableMessageSearch:false,entries:this.state.newParticipants,excludeGroups:true,excludePages:true,forceHideClearButton:true,hasHoverState:false,hideViewWithEntries:false,onAddEntryAttempt:this.$RTCGroupCallAddMembersDialog4,onClear:this.$RTCGroupCallAddMembersDialog5,onRemoveEntryAttempt:this.$RTCGroupCallAddMembersDialog6,originalEntryIDs:c("immutable").Set(this.props.participants.keySeq().toArray().map(function(u){return c("MercuryIDs").getUserIDFromParticipantID(u)||u})),placeholder:i._("Add to group:"),showDefaultEntries:true,shouldQueryInternalBot:false,shouldQueryVCEndpoint:false,scrollableViewClassName:"_2el2",useLayer:false,viewer:this.props.viewerID,width:m})))};n.prototype.$RTCGroupCallAddMembersDialog7=function(o){if(this.state.newParticipants.size)if(c("MessengerAdminGroupUtils").isJoinableThread(o))this.state.newParticipants.forEach(function(q){var p=c("MercuryIDs").getThreadIDFromUserID(q.getUniqueID());this.$RTCGroupCallAddMembersDialog8().send(this.$RTCGroupCallAddMembersDialog9().constructUserGeneratedMessageObject(o.joinable_mode.link,c("MercuryTriodeSourceUtil").getMercuryTriodeSource(),p))}.bind(this));else{var p="thread:"+(o.thread_fbid||o.thread_id.split(".")[1]);this.$RTCGroupCallAddMembersDialog8().send(this.$RTCGroupCallAddMembersDialog9().constructLogMessageObject(c("MercuryTriodeSourceUtil").getMercuryTriodeSource(),p,c("MercuryLogMessageType").SUBSCRIBE,{added_participants:this.state.newParticipants.map(function(q){return c("MercuryIDs").getParticipantIDFromUserID(q.getUniqueID())}).toArray()}))}};n.prototype.$RTCGroupCallAddMembersDialog8=function(){return c("MercuryMessageActions").getForFBID(this.props.viewerID)};n.prototype.$RTCGroupCallAddMembersDialog9=function(){return c("MercuryMessageObject").getForFBID(this.props.viewerID)};n.prototype.$RTCGroupCallAddMembersDialog3=function(){return this.props.participants.filter(function(o,p){return this.state.isParticipantSelected.get(p)}.bind(this)).toArray()};f.exports=c("FluxContainer").create(n)}),null);
__d("RTCIceCandidate",[],(function a(b,c,d,e,f,g){"use strict";f.exports=window.RTCIceCandidate||window.mozRTCPeerConnection}),null);
__d("RTCPeerConnection",[],(function a(b,c,d,e,f,g){"use strict";f.exports=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection}),null);
__d("RTCSessionDescription",["FBRTCMediaType","FBRTCSdpUtils","FBRTCConstants"],(function a(b,c,d,e,f,g){"use strict";var h=c("FBRTCConstants").SignalingProtocol,i=window.RTCSessionDescription||window.mozRTCSessionDescription,j=2,k="o",l="m",m="a",n="rtpmap",o="ssrc-group",p="ssrc",q="cname",r="msid",s="mslabel",t="label",u="sendonly",v="recvonly",w="sendrecv",x="inactive",y="offer",z="answer",A="=",B=" ",C=":",D="\r\n",E="audio",F="video",G="application",H=function H(O,P){return O.startsWith(P+A)},I=function I(O){return O.substr(j)},J=function J(O,P){return O.startsWith(P+D)||O.startsWith(P+C)},K=function K(O,P){return O.substr(P.length+1)};function L(O){this.$SessionDescription1=[];this.$SessionDescription2="-";this.$SessionDescription3="multiway";this.$SessionDescription4=1;this.$SessionDescription5="IN";this.$SessionDescription6="IP4";this.$SessionDescription7="127.0.0.1";O.forEach(function(P){if(H(P,k)){var Q=I(P).split(B);if(Q.length==6){this.$SessionDescription2=Q[0];this.$SessionDescription3=Q[1];this.$SessionDescription4=parseInt(Q[2],10);this.$SessionDescription5=Q[3];this.$SessionDescription6=Q[4];this.$SessionDescription7=Q[5]}}this.$SessionDescription1.push(P)}.bind(this))}L.prototype.setVersion=function(O){this.$SessionDescription4=O};L.prototype.getVersion=function(){return this.$SessionDescription4};L.prototype.toSdp=function(){return this.$SessionDescription1.map(function(O){if(H(O,k))return k+A+this.$SessionDescription2+B+this.$SessionDescription3+B+this.$SessionDescription4+B+this.$SessionDescription5+B+this.$SessionDescription6+B+this.$SessionDescription7;else return O}.bind(this)).join(D)};function M(O,P){var Q=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];this.$MediaDescription1=[];var R={},S=[],T=[];O.forEach(function(U){var V=I(U);if(H(U,l))this.$MediaDescription4=V.split(B)[0];if(H(U,m)&&J(V,n)){var W=K(V,n),X=W.split(B),Y=X[0],Z=X[1];R[Z]=Y}if(H(U,m)&&J(V,p))this.$MediaDescription6(V,S);else if(H(U,m)&&J(V,o))this.$MediaDescription7(V,T);else if(H(U,m)&&(V===u||V===v||V===w||V===x))this.$MediaDescription5=V;else this.$MediaDescription1.push(U)}.bind(this));Object.keys(Q).forEach(function(U){if(R[U]){var V=Object.keys(Q[U]).map(function(W){return W+"="+Q[U][W]}).join(";");this.$MediaDescription1.push("a=fmtp:"+R[U]+" "+V)}}.bind(this));this.$MediaDescription3={};this.$MediaDescription2={};S.forEach(function(U){if(Object.prototype.hasOwnProperty.call(U,q)){var V=U.cname;if(!this.$MediaDescription3[V])this.$MediaDescription3[V]=[U];else this.$MediaDescription3[V].push(U);var W=this.findSsrcGroupForSsrc(T,U.ssrc);if(W){if(!this.$MediaDescription2[V])this.$MediaDescription2[V]=[W];else this.$MediaDescription2[V].push(W);this.removeSsrcGroup(W,T)}}}.bind(this));if(this.$MediaDescription4!==G)if(P===y)if(S.length===0)this.$MediaDescription5=v;else this.$MediaDescription5=w;else if(P===z)this.$MediaDescription5=w}M.prototype.getMediaType=function(){return this.$MediaDescription4};M.prototype.findSsrcGroupForSsrc=function(O,P){return O.find(function(Q){var R=Q.ssrcs;return R.some(function(S){return S===P})})};M.prototype.addStreamsForEndpoint=function(O,P){this.$MediaDescription3[O]=P};M.prototype.addSsrcGroupsForEndpoint=function(O,P){this.$MediaDescription3[O].forEach(function(Q){var R=Q.ssrc,S=this.findSsrcGroupForSsrc(P,R);if(S){if(!this.$MediaDescription2[O])this.$MediaDescription2[O]=[S];else this.$MediaDescription2[O].push(S);this.removeSsrcGroup(S,P)}}.bind(this))};M.prototype.removeSsrcGroup=function(O,P){var Q=P.indexOf(O);if(Q!==-1)P.splice(Q,1)};M.prototype.$MediaDescription7=function(O,P){var Q=K(O,o);if(Q){var R=Q.split(B),S=R[0],T=R.slice(1);P.push({semantics:S,ssrcs:T.map(function(U){return parseInt(U,10)})})}};M.prototype.$MediaDescription6=function(O,P){var Q=O.indexOf(B),R=O.substr(0,Q),S=parseInt(K(R,p),10),T=O.substr(Q+1),U=P.find(function(U){return U.ssrc===S});if(!U){U={};U.ssrc=S;P.push(U)}if(J(T,q))U.cname=K(T,q);else if(J(T,r)){var V=K(T,r).split(B);U.msid={id:V[0],appdata:V[1]}}else if(J(T,s))U.mslabel=K(T,s);else if(J(T,t))U.label=K(T,t)};M.prototype.toSdp=function(){var O=[];this.$MediaDescription1.forEach(function(R){O.push(R)});for(var P in this.$MediaDescription2)this.$MediaDescription2[P].forEach(function(R){O.push(m+A+o+C+R.semantics+B+R.ssrcs.join(B))});O.push(m+A+this.$MediaDescription5);for(var Q in this.$MediaDescription3)this.$MediaDescription3[Q].forEach(function(R){if(R.cname)O.push(m+A+p+C+R.ssrc+B+q+C+R.cname);if(R.msid)O.push(m+A+p+C+R.ssrc+B+r+C+R.msid.id+(R.msid.appdata?B+R.msid.appdata:""));if(R.mslabel)O.push(m+A+p+C+R.ssrc+B+s+C+R.mslabel);if(R.label)O.push(m+A+p+C+R.ssrc+B+t+C+R.label)});return O.join(D)};function N(O){var P=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],Q=arguments.length<=2||arguments[2]===undefined?{}:arguments[2],R=P.type,S=R===undefined?"offer":R,T=P.sdp,U=T===undefined?"":T;this.$RTCSessionDescription2=O;this.type=S;switch(O){case h.CUSTOM:this.$RTCSessionDescription1=U;return;case h.MULTIWAY:this.$RTCSessionDescription3(U,Q);return;case h.P2P:this.$RTCSessionDescription4(U,Q);return}}N.prototype.$RTCSessionDescription3=function(O,P){var Q=O.trim().split(D),R=[],S=0;while(S<Q.length&&!H(Q[S],l)){R.push(Q[S]);S++}this.sessionDescription=new L(R);this.mediaDescriptions=[];while(S<Q.length){var T=[];T.push(Q[S]);S++;while(S<Q.length&&!H(Q[S],l)){T.push(Q[S]);S++}this.mediaDescriptions.push(new M(T,this.type,P.FORMAT_PARAMETERS))}};N.prototype.$RTCSessionDescription4=function(O,P){var Q=[];if(this.type==="offer"){if(P.DISABLE_VIDEO)Q.push(function(O){return c("FBRTCSdpUtils").disableVideo(O)});Q.push(function(O){return c("FBRTCSdpUtils").addIceOptionToSdp(O,"fb-force-5245")},function(O){return c("FBRTCSdpUtils").replaceRTPSAVPFProfile(O)},function(O){return c("FBRTCSdpUtils").preferIsac(O)},function(O){return c("FBRTCSdpUtils").removeSdparta(O)},function(O){return c("FBRTCSdpUtils").addNullVideo(O)},function(O){return c("FBRTCSdpUtils").addSetup(O)});if(P.ADD_AUDIO_NACK)Q.push(function(O){return c("FBRTCSdpUtils").addAudioNack(O)})}else{Q.push(function(O){return c("FBRTCSdpUtils").addIceOptionToSdp(O,"fb-force-5245")},function(O){return c("FBRTCSdpUtils").addNullVideo(O)});if(P.USE_DTLS_OVER_CRYPTO)Q.push(function(O){return c("FBRTCSdpUtils").useDTLSOverCrypto(O)})}this.$RTCSessionDescription1=Q.reduce(function(O,R){return R(O)},O)};N.prototype.processServerMediaUpdate=function(O){var P=O.sourceKey,Q=O.media,R=O.ssrcGroups,S=[],T=[];Q.forEach(function(U){U.ssrcs.forEach(function(V){var W={ssrc:V,cname:P,msid:{id:P,appdata:U.id},label:U.id,mslabel:P};if(c("FBRTCMediaType").AUDIO===U.type)S.push(W);else if(c("FBRTCMediaType").VIDEO===U.type)T.push(W)})});this.mediaDescriptions.forEach(function(U){if(U.getMediaType()===E){U.addStreamsForEndpoint(P,S);U.addSsrcGroupsForEndpoint(P,R)}else if(U.getMediaType()===F){U.addStreamsForEndpoint(P,T);U.addSsrcGroupsForEndpoint(P,R)}})};N.prototype.toDesc=function(){return new i({type:this.type,sdp:this.toSdp()})};N.prototype.toSdp=function(){var O=this.$RTCSessionDescription2;switch(O){case h.MULTIWAY:return[this.sessionDescription.toSdp(),this.mediaDescriptions.map(function(P){return P.toSdp()}).join(D),""].join(D);case h.CUSTOM:case h.P2P:default:return this.$RTCSessionDescription1}};N.prototype.strongDiff=function(O){var P=this.toSdp(),Q=O.toSdp();return P!==Q&&this.$RTCSessionDescription5(P)!==this.$RTCSessionDescription5(Q)};N.prototype.$RTCSessionDescription5=function(O){return this.$RTCSessionDescription6(O).split("\r\n").filter(function(P){return!/^a=(candidate|setup):/.test(P)}).join("\r\n")};N.prototype.$RTCSessionDescription6=function(O){return O.replace(/(o=\S+\s\S+)\s\S+\s/,"$1 - ")};f.exports=N}),null);
__d("FBRTCPeerConnection",["Promise","regeneratorRuntime","FBRTCSdpUtils","Map","RTCIceCandidate","RTCPeerConnection","RTCSessionDescription","UserAgent"],(function a(b,c,d,e,f,g){"use strict";function h(w){var x=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],y=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];this.$FBRTCPeerConnection3=[];this.$FBRTCPeerConnection4=[];this.$FBRTCPeerConnection7=new(c("Map"))();this.addEventListener=function(z,A){var B=this.$FBRTCPeerConnection7.get(z);if(!Array.isArray(B)){B=[];this.$FBRTCPeerConnection7.set(z,B)}B.push(A);this.$FBRTCPeerConnection5.addEventListener(z,A)};this.removeEventListener=function(z,A){var B=this.$FBRTCPeerConnection7.get(z);if(Array.isArray(B)){B=B.filter(function(C){return C!==A});if(B.length<1)this.$FBRTCPeerConnection7["delete"](z);else this.$FBRTCPeerConnection7.set(z,B)}this.$FBRTCPeerConnection5.removeEventListener(z,A)};this.$FBRTCPeerConnection9=function(z){var A=z.candidate;if(A)this.$FBRTCPeerConnection4.push(A)}.bind(this);this.$FBRTCPeerConnection10=function(z){var A=z.channel;this.$FBRTCPeerConnection11(A)}.bind(this);this.$FBRTCPeerConnection6=w;this.$FBRTCPeerConnection1=x;this.$FBRTCPeerConnection2=y;this.$FBRTCPeerConnection5=this.$FBRTCPeerConnection8()}h.prototype.$FBRTCPeerConnection8=function(){var w=new(c("RTCPeerConnection"))(this.$FBRTCPeerConnection1,this.$FBRTCPeerConnection2);w.addEventListener("icecandidate",this.$FBRTCPeerConnection9);w.addEventListener("datachannel",this.$FBRTCPeerConnection10);for(var x=this.$FBRTCPeerConnection7.entries(),y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var A;if(y){if(z>=x.length)break;A=x[z++]}else{z=x.next();if(z.done)break;A=z.value}var B=A,C=B[0],D=B[1];for(var E=D,F=Array.isArray(E),G=0,E=F?E:E[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var H;if(F){if(G>=E.length)break;H=E[G++]}else{G=E.next();if(G.done)break;H=G.value}var I=H;w.addEventListener(C,I)}}return w};h.prototype.reset=function(){var w=this.$FBRTCPeerConnection5;for(var x=this.$FBRTCPeerConnection7.entries(),y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var A;if(y){if(z>=x.length)break;A=x[z++]}else{z=x.next();if(z.done)break;A=z.value}var B=A,C=B[0],D=B[1];for(var E=D,F=Array.isArray(E),G=0,E=F?E:E[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var H;if(F){if(G>=E.length)break;H=E[G++]}else{G=E.next();if(G.done)break;H=G.value}var I=H;w.removeEventListener(C,I)}}w.removeEventListener("datachannel",this.$FBRTCPeerConnection9);w.removeEventListener("icecandidate",this.$FBRTCPeerConnection9);this.$FBRTCPeerConnection3=[];this.$FBRTCPeerConnection4=[];this.$FBRTCPeerConnection5=this.$FBRTCPeerConnection8();for(var J=w.getLocalStreams(),K=Array.isArray(J),L=0,J=K?J:J[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var M;if(K){if(L>=J.length)break;M=J[L++]}else{L=J.next();if(L.done)break;M=L.value}var N=M;this.addStream(N)}return c("Promise").race([new(c("Promise"))(function(O){var P=this.$FBRTCPeerConnection5,Q=function Q(R){var S=R.target;if(S.iceConnectionState!=="checking"&&S.iceConnectionState!=="new"){O();P.removeEventListener("iceconnectionstatechange",Q);q(w)}};P.addEventListener("iceconnectionstatechange",Q)}.bind(this)),new(c("Promise"))(function(O){return setTimeout(O,5e3)})])["catch"](function(O){return c("Promise").resolve()}).then(function(){q(w)})};h.prototype.close=function(){q(this.$FBRTCPeerConnection5)};h.prototype.getCreatedIceCandidates=function(){return this.$FBRTCPeerConnection4};h.prototype.$FBRTCPeerConnection11=function(w){w.addEventListener("close",function(){this.$FBRTCPeerConnection3=this.$FBRTCPeerConnection3.filter(function(x){return x!==w})}.bind(this));this.$FBRTCPeerConnection3.push(w)};h.prototype.onReceivedRemoteIceCandidate=function(w){var x=w.sdp,y=w.label,z=w.sdp_mid,A=new(c("RTCIceCandidate"))({sdpMLineIndex:y,candidate:c("FBRTCSdpUtils").fixMobileIceSdp(x),sdpMid:z});this.$FBRTCPeerConnection5.addIceCandidate(A)};h.prototype.getLocalStreams=function(){return this.$FBRTCPeerConnection5.getLocalStreams()};h.prototype.getRemoteStreams=function(){return this.$FBRTCPeerConnection5.getRemoteStreams()};h.prototype.addStream=function(w,x){if(r("addTrack"))for(var y=w.getTracks(),z=Array.isArray(y),A=0,y=z?y:y[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var B;if(z){if(A>=y.length)break;B=y[A++]}else{A=y.next();if(A.done)break;B=A.value}var C=B,D=this.$FBRTCPeerConnection5.addTrack(C,w);if(x)x(D)}else this.$FBRTCPeerConnection5.addStream(w)};h.prototype.removeStream=function(w){var x,y=this;if(r("removeTrack")&&r("getSenders"))(function(){var z=w.getTracks(),A=y.$FBRTCPeerConnection5.getSenders().filter(function(F){return z.includes(F.track)});for(var B=A,C=Array.isArray(B),D=0,B=C?B:B[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var E;if(C){if(D>=B.length)break;E=B[D++]}else{D=B.next();if(D.done)break;E=D.value}var F=E;y.$FBRTCPeerConnection5.removeTrack(F)}})();else this.$FBRTCPeerConnection5.removeStream(w)};h.prototype.createOffer=function w(){var x=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],y=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],z=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];return c("regeneratorRuntime").async(function A(B){while(1)switch(B.prev=B.next){case 0:return B.abrupt("return",j(this.$FBRTCPeerConnection5,x).then(function(C){return v(C,z)}).then(function(C){return new(c("RTCSessionDescription"))(this.$FBRTCPeerConnection6,C,{FORMAT_PARAMETERS:y})}.bind(this)));case 1:case"end":return B.stop()}},null,this)};h.prototype.createAnswer=function w(){return c("regeneratorRuntime").async(function x(y){while(1)switch(y.prev=y.next){case 0:return y.abrupt("return",k(this.$FBRTCPeerConnection5).then(function(z){return new(c("RTCSessionDescription"))(this.$FBRTCPeerConnection6,z)}.bind(this)));case 1:case"end":return y.stop()}},null,this)};h.prototype.setLocalDescription=function w(x){return c("regeneratorRuntime").async(function y(z){while(1)switch(z.prev=z.next){case 0:return z.abrupt("return",o(this.$FBRTCPeerConnection5,x.toDesc()).then(function(){return x}));case 1:case"end":return z.stop()}},null,this)};h.prototype.setRemoteDescription=function w(x){return c("regeneratorRuntime").async(function y(z){while(1)switch(z.prev=z.next){case 0:return z.abrupt("return",p(this.$FBRTCPeerConnection5,x.toDesc()).then(function(){return x}));case 1:case"end":return z.stop()}},null,this)};h.prototype.getLocalDescription=function(){return new(c("RTCSessionDescription"))(this.$FBRTCPeerConnection6,this.$FBRTCPeerConnection5.localDescription||{})};h.prototype.getRemoteDescription=function(){return new(c("RTCSessionDescription"))(this.$FBRTCPeerConnection6,this.$FBRTCPeerConnection5.remoteDescription||{})};h.prototype.getSignalingState=function(){return this.$FBRTCPeerConnection5.signalingState};h.prototype.getIceGatheringState=function(){return this.$FBRTCPeerConnection5.iceGatheringState};h.prototype.getIceConnectionState=function(){return this.$FBRTCPeerConnection5.iceConnectionState};h.prototype.getStats=function w(x){return c("regeneratorRuntime").async(function y(z){while(1)switch(z.prev=z.next){case 0:if(!(x!=null)){z.next=2;break}return z.abrupt("return",c("Promise").reject(new Error("getStats() doesn't support selector (yet)")));case 2:if(!c("UserAgent").isBrowser("Edge")){z.next=4;break}return z.abrupt("return",c("Promise").resolve(new(c("Map"))()));case 4:if(!c("UserAgent").isBrowser("Firefox")){z.next=6;break}return z.abrupt("return",c("Promise").resolve(this.$FBRTCPeerConnection5.getStats()).then(function(A){if(c("UserAgent").isBrowser("Firefox >= 48"))return A;return t(A)}).then(function(A){if(c("UserAgent").isBrowser("Firefox >= 53"))return A;try{A.forEach(function(C){C.type=u(C.type)})}catch(B){if(B.name!=="TypeError")throw B;A.forEach(function(C,D){A.set(D,babelHelpers["extends"]({},C,{type:u(C.type)}))})}return A}));case 6:if(!(c("UserAgent").isBrowser("Chrome")||c("UserAgent").isBrowser("Opera"))){z.next=8;break}return z.abrupt("return",new(c("Promise"))(function(A,B){this.$FBRTCPeerConnection5.getStats(A,B)}.bind(this)).then(function(A){var B={};for(var C=A.result(),D=Array.isArray(C),E=0,C=D?C:C[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var F;if(D){if(E>=C.length)break;F=C[E++]}else{E=C.next();if(E.done)break;F=E.value}var G=F,H={id:G.id,timestamp:G.timestamp,type:u(G.type)};for(var I=G.names(),J=Array.isArray(I),K=0,I=J?I:I[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var L;if(J){if(K>=I.length)break;L=I[K++]}else{K=I.next();if(K.done)break;L=K.value}var M=L;H[M]=G.stat(M)}B[H.id]=H}return B}).then(t));case 8:return z.abrupt("return",c("Promise").reject(new Error("getStats() not supported")));case 9:case"end":return z.stop()}},null,this)};h.prototype.createDataChannel=function(w,x){if(this.$FBRTCPeerConnection5.createDataChannel){var y=this.$FBRTCPeerConnection5.createDataChannel(w,x);this.$FBRTCPeerConnection11(y);return y}return null};h.prototype.getDataChannelByLabel=function(w){return this.$FBRTCPeerConnection3.find(function(x){return x.label===w})};var i=c("UserAgent").isBrowser("Chrome < 52")||c("UserAgent").isBrowser("Opera < 39")||c("UserAgent").isBrowser("Firefox < 37");function j(w,x){if(i)return new(c("Promise"))(function(y,z){return w.createOffer(y,z,m(x))});return c("Promise").resolve(w.createOffer(m(x)))}function k(w){if(i)return new(c("Promise"))(function(x,y){return w.createAnswer(x,y)});return c("Promise").resolve(w.createAnswer())}var l=c("UserAgent").isBrowser("Chrome < 38")||c("UserAgent").isBrowser("Opera < 26");function m(w){var x=w.offerToReceiveAudio,y=x===undefined?true:x,z=w.offerToReceiveVideo,A=z===undefined?true:z,B=babelHelpers.objectWithoutProperties(w,["offerToReceiveAudio","offerToReceiveVideo"]);if(l){if(Object.keys(B).length>0)return{mandatory:{OfferToReceiveAudio:y,OfferToReceiveVideo:A},optional:babelHelpers["extends"]({},s(B))};return{mandatory:{OfferToReceiveAudio:y,OfferToReceiveVideo:A}}}return babelHelpers["extends"]({offerToReceiveAudio:y,offerToReceiveVideo:A},B)}var n=c("UserAgent").isBrowser("Chrome < 51")||c("UserAgent").isBrowser("Opera < 38")||c("UserAgent").isBrowser("Firefox < 37");function o(w,x){if(n)return new(c("Promise"))(function(y,z){return w.setLocalDescription(x,y,z)});return c("Promise").resolve(w.setLocalDescription(x))}function p(w,x){if(n)return new(c("Promise"))(function(y,z){return w.setRemoteDescription(x,y,z)});return c("Promise").resolve(w.setRemoteDescription(x))}function q(w){if(w&&w.signalingState!=="closed")w.close()}function r(w){return w in c("RTCPeerConnection").prototype}function s(w){var x={};for(var y=Object.keys(w),z=Array.isArray(y),A=0,y=z?y:y[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var B;if(z){if(A>=y.length)break;B=y[A++]}else{A=y.next();if(A.done)break;B=A.value}var C=B,D=""+C.substr(0,1).toUpperCase()+C.substr(1);x[D]=w[C]}return x}function t(w){return new(c("Map"))(Object.keys(w).map(function(x){return[x,w[x]]}))}function u(w){switch(w){case"inbound-rtp":return"inboundrtp";case"outbound-rtp":return"outboundrtp";case"candidate-pair":return"candidatepair";case"local-candidate":return"localcandidate";case"remote-candidate":return"remotecandidate";default:return w}}function v(w,x){var y=x.audio,z=x.video,A=w.sdp,B=w.type;if(y)A=c("FBRTCSdpUtils").preferCodec(A,y,false);if(z)A=c("FBRTCSdpUtils").preferCodec(A,z,true);return c("Promise").resolve({sdp:A,type:B})}f.exports=h}),null);
__d("XGroupCallSendRequestController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/groupcall/sendrequest/",{webrtc_fbtrace:{type:"Int"}})}),null);
__d("MultiwayRequests",["Promise","AsyncRequest","FBRTCCapability","FBRTCMessageType","RTCConfig","RTCUtils","XGroupCallSendRequestController"],(function a(b,c,d,e,f,g){"use strict";var h=15e3;function i(){}i.prototype.sendJoinRequest=function(j,k,l,m,n,o){var p=c("RTCUtils").createRequestHeader(c("FBRTCMessageType").JOIN,k,l),q={offer:{sdpString:m.toSdp()},deviceCapabilities:[c("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,c("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED],userCapabilities:JSON.stringify({CAN_BE_MUTED:c("RTCConfig").RtcRemoteMuteCapability})};if(n&&n.length>0)q.usersToCall=n;if(o)q.mediaStatus=o;var r={endpoint:j,jsonPayload:{header:p,body:{joinRequest:q}}};return this.$MultiwayRequests1(r)};i.prototype.sendHangupRequest=function(j,k,l,m,n){var o=c("RTCUtils").createRequestHeader(c("FBRTCMessageType").HANGUP,k,l),p={reason:m,detailedReasonString:n},q={endpoint:j,jsonPayload:{header:o,body:{hangupRequest:p}}};return this.$MultiwayRequests1(q)};i.prototype.sendAddParticipantsRequest=function(j,k,l,m){var n=c("RTCUtils").createRequestHeader(c("FBRTCMessageType").ADD_PARTICIPANTS,k,l),o={usersToInvite:m},p={endpoint:j,jsonPayload:{header:n,body:{addParticipantsRequest:o}}};return this.$MultiwayRequests1(p)};i.prototype.sendSubscriptionRequest=function(j,k,l,m){return this.$MultiwayRequests1({endpoint:j,jsonPayload:{header:c("RTCUtils").createRequestHeader(c("FBRTCMessageType").SUBSCRIPTION,k,l),body:{subscriptionRequest:{subscriptions:m}}}})};i.prototype.sendClientMediaUpdateRequest=function(j,k,l,m,n,o){return this.$MultiwayRequests1({endpoint:j,jsonPayload:{header:c("RTCUtils").createRequestHeader(c("FBRTCMessageType").CLIENT_MEDIA_UPDATE,k,l),body:{clientMediaUpdateRequest:{fromVersion:m,toVersion:n,mediaUpdates:o}}}})};i.prototype.$MultiwayRequests1=function(j){return new(c("Promise"))(function(k,l){var m=c("XGroupCallSendRequestController").getURIBuilder().getURI(),n=new(c("AsyncRequest"))(m).setMethod("POST").setData({request:JSON.stringify(j)}).setAllowCrossPageTransition(true).setHandler(function(o){k(o.payload)}).setErrorHandler(function(o){var p=o.getErrorDescription(),q=Error(p!=null?p.toString():"AsyncRequest error");l(q)}).setTimeoutHandler(h,function(){l("Timeout")});n.send()})};f.exports=new i()}),null);
__d("RTCMWProtocolHandler",["regeneratorRuntime","Promise","AsyncRequest","FBRTCConstants","Base64","ChannelManager","CurrentUser","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCGroupCallStore","FBRTCPeerConnection","FBRTCRtcResponseStatusCode","FBRTCSdpUtils","FBRTCVideoQuality","MercuryIDs","MercuryParticipants","MercuryParticipantsConstants","MultiwayParticipantFetcher","MultiwayRequests","RTCCallActions","RTCCallStore","RTCConfig","RTCGroupCallActions","RTCMultiwayMessageHandler","RTCSessionDescription","RTCUtils","emptyFunction"],(function a(b,c,d,e,f,g){"use strict";var h=c("FBRTCConstants").CallEndReason,i=c("FBRTCConstants").CallType,j=c("FBRTCConstants").GroupVideoViewLayout,k=c("FBRTCConstants").IceConnectionState,l=c("FBRTCConstants").SignalingProtocol,m="229895473858072",n=18e4,o={appId:m,deviceId:c("ChannelManager").getCompleteConfig().sessionID,userId:c("CurrentUser").getID()};c("ChannelManager").startChannelManager();function p(){var r=arguments.length<=0||arguments[0]===undefined?null:arguments[0];this.$RTCMWProtocolHandler4=false;this.$RTCMWProtocolHandler7=function(s){var t=s.target;c("RTCCallActions").emit("onIceConnectionStateChange",t.iceConnectionState);switch(t.iceConnectionState){case k.DISCONNECTED:case k.FAILED:if(!this.$RTCMWProtocolHandler2)this.$RTCMWProtocolHandler2=setTimeout(function(){c("RTCCallActions").endCall(h.CONNECTION_DROPPED,"ConnectionDropped");var u=c("RTCCallStore").getState(),v=u.connections;c("RTCMultiwayMessageHandler").close();v.forEach(function(w){return w.close()});c("RTCCallActions").removeAllLocalStreams(true)},n);break;default:clearTimeout(this.$RTCMWProtocolHandler2);this.$RTCMWProtocolHandler2=null}}.bind(this);this.$RTCMWProtocolHandler1=r}p.prototype.startCall=function(r,s,t,u){var v=u.addStreamCallback,w=v===undefined?c("emptyFunction"):v,x=u.callTrigger,y=u.formatParameters,z=y===undefined?{}:y,A=u.preferredCodecs,B=A===undefined?{}:A,C=u.serverInfoData,D=u.shouldSetDescriptions,E=D===undefined?true:D;c("RTCCallActions").initialize(l.MULTIWAY,t,C,this.$RTCMWProtocolHandler1,x);var F=c("FBRTCCallSummary").restoreOrInitialize(c("FBRTCCallSummaryStore").getInstance(),c("RTCUtils").isGroupCall(t)?-1:c("RTCUtils").getPeerID(t),this.$RTCMWProtocolHandler1,!C);x&&F.onCallStarted(x);F.setIsUsingMultiway(1);F.onPopupOpened();F.setConferenceName(t);F.setServerInfoData(C);F.save(c("FBRTCCallSummaryStore").getInstance());c("RTCCallActions").setCallSummary(F);c("RTCGroupCallActions").setMWCallType(s.some(function(J){return J.getVideoTracks().length>0})?i.DIRECT_VIDEO:i.VOIP);var G={mandatory:{},optional:[{googNumUnsignalledRecvStreams:10},{googHighBitrate:true},{googVeryHighBitrate:true},{RtpDataChannels:true}]};if(!c("RTCConfig").RtcUseDtlsGK)G.optional.push({DtlsSrtpKeyAgreement:false});var H=new(c("FBRTCPeerConnection"))(l.MULTIWAY,{iceServers:[]},G),I=H.createDataChannel("data");if(I)I.onmessage=function(J){var K=J.data;try{var L=JSON.parse(K),M=L.body;this.$RTCMWProtocolHandler5(M)}catch(N){}}.bind(this);H.addEventListener("addstream",function(event){this.$RTCMWProtocolHandler6(t,event.stream)}.bind(this));H.addEventListener("removestream",function(event){c("RTCCallActions").removeRemoteStream(event.stream)});H.addEventListener("iceconnectionstatechange",this.$RTCMWProtocolHandler7);this.$RTCMWProtocolHandler8(H,s,t,C,r,w,z,B,E);if(!C)c("RTCCallActions").call(r,H);else c("RTCCallActions").join(H);return H};p.prototype.$RTCMWProtocolHandler6=function(r,s){s.onaddtrack=function(u){var v=u.target,w=u.track;c("RTCCallActions").addRemoteTrack(v,w)};s.onremovetrack=function(u){var v=u.target,w=u.track;c("RTCCallActions").removeRemoteTrack(v,w)};var t=s.id.split(":")[0];if(t!==c("CurrentUser").getID())c("MultiwayParticipantFetcher").fetchParticipant(r,t).done(function(u){var v={},w=c("MercuryIDs").getParticipantIDFromUserID(t);c("MercuryParticipants").getBigImageMulti([w],function(x){v[w]=u;c("RTCGroupCallActions").onParticipantsAdded(v,x);c("RTCCallActions").addRemoteStream(s);var y=c("RTCCallStore").getState(),z=y.callInfo,A=y.connections,B=c("FBRTCGroupCallStore").getState(),C=B.layout,D=B.pinnedSpeakerFBID;p.subscription(z.conferenceName,z.serverInfoData,A.first().getRemoteStreams(),C,D)},c("MercuryParticipantsConstants").WWW_INCALL_THUMBNAIL_SIZE)})};p.prototype.$RTCMWProtocolHandler5=function(r){if(r.genericMessage&&r.genericMessage.data){var s=JSON.parse(c("Base64").decode(r.genericMessage.data)),t=!c("RTCCallStore").getState().localUser.isAudioMuted();if(s.RTC_REMOTE_COMMAND==="MUTE_SELF"&&t)c("RTCCallActions").toggleMuteAudio(false)}else if(r.dominantSpeakerNotification){var u=r.dominantSpeakerNotification.userId;c("RTCGroupCallActions").setDominantSpeaker(u)}};p.prototype.setDescriptions=function(){this.$RTCMWProtocolHandler4=true;var r=c("RTCCallStore").getState().connections.first();if(this.$RTCMWProtocolHandler3)r.setRemoteDescription(this.$RTCMWProtocolHandler3)};p.videoEscalation=function(){return c("RTCUtils").initLocalStream(true).then(function(r){var s=c("RTCCallStore").getState(),t=s.callInfo,u=t.conferenceName,v=t.serverInfoData,w=s.connections,x=s.localUser;r.getTracks().forEach(function(z){if(z.kind==="audio")z.enabled=!x.isAudioMuted()});var y=x.streams.first();w.first().removeStream(y);return q(w.first(),[r],u,v,[]).then(function(){c("RTCCallActions").removeLocalStream(y);c("RTCCallActions").addLocalStream(r);c("RTCGroupCallActions").setMWCallType(i.ESCALATED)})})};p.endCall=function(r,s,t){var u=arguments.length<=3||arguments[3]===undefined?"":arguments[3];p.genEndCall(r,s,t,u).done()};p.genEndCall=function(r,s,t){var u=arguments.length<=3||arguments[3]===undefined?"":arguments[3];c("RTCMultiwayMessageHandler").close();c("RTCCallActions").removeAllLocalStreams(true);c("RTCCallActions").hangup(t,u);return c("MultiwayRequests").sendHangupRequest(o,r,s,t,u||"Hangup by user").then(function(){c("RTCCallActions").hangupSuccess()})["catch"](function(v){c("RTCCallActions").hangupError();throw v})};p.otherUserInAnotherCall=function(r,s,t){var u=arguments.length<=3||arguments[3]===undefined?"":arguments[3];c("MultiwayRequests").sendHangupRequest(o,r,s,t,u||"User receiving this call is in another call").done()};p.prototype.iceRestart=function(r,s){q(c("RTCCallStore").getState().connections.first(),[],r,s,[],{iceRestart:true})};p.addParticipants=function(r,s,t){c("MultiwayRequests").sendAddParticipantsRequest(o,r,s,t)};p.subscription=function(r,s,t,u,v){var w=u===j.DOMINANT_SPEAKER?c("FBRTCVideoQuality").LOW:u===j.GRID?c("FBRTCVideoQuality").MEDIUM:c("FBRTCVideoQuality").HIGH,x=t.map(function(y){var z=y.id;return{cname:z,options:{videoQuality:u===j.DOMINANT_SPEAKER&&v===z.split(":")[0]?c("FBRTCVideoQuality").HIGH:w}}});if(u===j.DOMINANT_SPEAKER&&!v)x.push({cname:""});c("MultiwayRequests").sendSubscriptionRequest(o,r,s,x)};p.clientMediaUpdate=function(r,s,t,u,v){c("MultiwayRequests").sendClientMediaUpdateRequest(o,r,s,t,u,v).then(function(w){var x=w.header.responseStatusCode,y=w.body.clientMediaUpdateResponse.currentVersion;return c("RTCGroupCallActions").onClientMediaUpdateResponse(x,y)})["catch"](function(w){})};p.prototype.$RTCMWProtocolHandler8=function(r,s,t,u,v,w,x,y,z){this.$RTCMWProtocolHandler9(t,u);q(r,s,t,u,v,{},w,x,y,z).done(function(A){this.$RTCMWProtocolHandler3=A;if(this.$RTCMWProtocolHandler4)this.setDescriptions();c("RTCCallActions").callSuccess()}.bind(this),function(A){c("RTCCallActions").callError(A);var B=c("RTCCallStore").getState(),C=B.connections;c("RTCMultiwayMessageHandler").close();C.forEach(function(D){return D.close()});c("RTCCallActions").removeAllLocalStreams(true)})};p.prototype.$RTCMWProtocolHandler9=function(r,s){c("RTCMultiwayMessageHandler").initHandler(r,s)};function q(r,s,t,u,v){var w=arguments.length<=5||arguments[5]===undefined?{}:arguments[5],x=arguments.length<=6||arguments[6]===undefined?c("emptyFunction"):arguments[6],y=arguments.length<=7||arguments[7]===undefined?{}:arguments[7],z=arguments.length<=8||arguments[8]===undefined?{}:arguments[8],A=arguments.length<=9||arguments[9]===undefined?true:arguments[9],B,C,D,E,F,G;return c("regeneratorRuntime").async(function H(I){while(1)switch(I.prev=I.next){case 0:B={};C=[];s.forEach(function(J){C.concat(J.getTracks());r.addStream(J,x)});C.forEach(function(J){B[J.id]=true});I.next=6;return c("regeneratorRuntime").awrap(r.createOffer(w,y,z));case 6:D=I.sent;if(c("FBRTCSdpUtils").validateOfferSdp(t,D.toSdp())){I.next=9;break}throw c("FBRTCRtcResponseStatusCode").BAD_REQUEST;case 9:I.next=11;return c("regeneratorRuntime").awrap(r.setLocalDescription(D));case 11:c("RTCGroupCallActions").onJoinRequestSent();I.next=14;return c("regeneratorRuntime").awrap(c("MultiwayRequests").sendJoinRequest(o,t,u,D,v.length>0?v:null,C.length>0?B:null));case 14:E=I.sent;F=E.header.responseStatusCode;if(!(F!==c("FBRTCRtcResponseStatusCode").OK)){I.next=18;break}return I.abrupt("return",new(c("Promise"))(function(J,K){K(F)}));case 18:c("RTCGroupCallActions").onJoinResponse(E.header.serverInfoData);G=new(c("RTCSessionDescription"))(l.MULTIWAY,{type:"answer",sdp:E.body.joinResponse.answer.sdpString},{FORMAT_PARAMETERS:y});if(!A){I.next=23;break}I.next=23;return c("regeneratorRuntime").awrap(r.setRemoteDescription(G));case 23:c("RTCGroupCallActions").toggleRemoteStream(E.body.joinResponse.mediaStatus);return I.abrupt("return",G);case 25:case"end":return I.stop()}},null,this)}f.exports=p}),null);
__d("FBRTCGroupCallIncomingController",["FBRTCConstants","FBRTCCallBlockingStore","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCCallUIWrapper","FBRTCCapability","FBRTCDeviceStatus","FBRTCHangupReason","FBRTCMultiwayMessage","FBRTCRingType","FBRTCRtcResponseStatusCode","FBRTCSupport","FBRTCTransactions","MessengerRTCGroupCallUnsupportedBrowserDialogController","RTCConfig","RTCMWProtocolHandler","RTCUtils"],(function a(b,c,d,e,f,g){var h,i,j=c("FBRTCConstants").CallEndReason,k=c("FBRTCTransactions").FBRTCTransactionOwner;h=babelHelpers.inherits(l,k);i=h&&h.prototype;function l(m){"use strict";i.constructor.call(this);this.$FBRTCGroupCallIncomingController1=m;this.$FBRTCGroupCallIncomingController2=null}l.prototype.onMessageReceived=function(m){"use strict";var n=new(c("FBRTCMultiwayMessage"))(m),o=this.getTransaction(n);o.start().then(function(p){if(p!=null)if(p.ringRequest()!=null){if(c("RTCUtils").isMessengerCall(p.conferenceName())&&!c("RTCConfig").RtcWwwMessengerPrefix||!c("RTCUtils").isGroupCall(p.conferenceName())&&!c("RTCConfig").RTCConferencingP2PCanReceiveGK)return;var q=c("RTCUtils").generateRandomInt(),r=new(c("FBRTCCallSummary"))({peerID:c("RTCUtils").isGroupCall(p.conferenceName())||c("RTCUtils").isMessengerCall(p.conferenceName())?-1:c("RTCUtils").getPeerID(p.conferenceName()),callID:q,isCaller:false});if(c("FBRTCCallBlockingStore").getBlockingStatus()){r.onCallEnded(j.IGNORE_CALL,false,false,"calling disabled");r.save(c("FBRTCCallSummaryStore").getInstance());return}if(!c("FBRTCSupport").isGroupCallWebtrcSupported()){r.onCallEnded(j.UNSUPPORTED_VERSION,false);r.save(c("FBRTCCallSummaryStore").getInstance());var s=p.ringRequest(),t=s.ringType;c("MessengerRTCGroupCallUnsupportedBrowserDialogController").render({hasVideo:c("RTCConfig").RtcConferencingVideoGK&&(t===c("FBRTCRingType").GROUP_VIDEO_CALL||t===c("FBRTCRingType").PEER_VIDEO_CALL)});return}o.sendResponse(this.handleRingRequest(p,q,r))}else if(p.dismissRequest()!=null)o.sendResponse(this.handleDismissRequest(p))}.bind(this),function(p){}).done()};l.prototype.cancelIncomingCallDialog=function(){"use strict";if(this.$FBRTCGroupCallIncomingController2){this.$FBRTCGroupCallIncomingController2.cancel();this.$FBRTCGroupCallIncomingController2=null}};l.prototype.handleDismissRequest=function(m){"use strict";c("MessengerRTCGroupCallUnsupportedBrowserDialogController").unmount();if(this.$FBRTCGroupCallIncomingController2){var n=this.$FBRTCGroupCallIncomingController2.serverInfoData();if(n==m.serverInfoData())this.cancelIncomingCallDialog()}return m.createResponse(c("FBRTCRtcResponseStatusCode").OK,{})};l.prototype.handleRingRequest=function(m,n,o){"use strict";var p=m.ringRequest(),q=m.serverInfoData();if(p==null||q==null)return m.createResponse(c("FBRTCRtcResponseStatusCode").BAD_REQUEST);var r=p.caller,s=p.otherParticipants,t=c("RTCConfig").RtcConferencingVideoGK&&(p.ringType==c("FBRTCRingType").GROUP_VIDEO_CALL||p.ringType==c("FBRTCRingType").PEER_VIDEO_CALL),u=new this.$FBRTCGroupCallIncomingController1(m.conferenceName(),n,r,s,t,q);u.addListener("answerCall",function(w,x){c("FBRTCCallUIWrapper").openGroupCallURI(w,n,t,q,"answer button",o)});u.addListener("ignoreCall",function(){c("RTCMWProtocolHandler").endCall(m.conferenceName(),q,c("FBRTCHangupReason").IGNORE_CALL);o.onCallEnded(j.IGNORE_CALL,false);o.save(c("FBRTCCallSummaryStore").getInstance());this.cancelIncomingCallDialog()}.bind(this));u.addListener("timeout",function(){c("RTCMWProtocolHandler").endCall(m.conferenceName(),q,c("FBRTCHangupReason").NO_ANSWER_TIMEOUT);o.onCallEnded(j.NO_ANSWER_TIMEOUT,false);o.save(c("FBRTCCallSummaryStore").getInstance());this.cancelIncomingCallDialog()}.bind(this));this.$FBRTCGroupCallIncomingController2=u;u.showIncomingDialog();var v={deviceCapabilities:[c("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,c("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED],deviceStatus:c("FBRTCDeviceStatus").OK};return m.createResponse(c("FBRTCRtcResponseStatusCode").OK,{ringResponse:v})};f.exports=l}),null);